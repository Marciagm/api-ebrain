/**
 * 画图表相关的服务封装
 */
package com.ebrain.api.service;

import java.awt.BasicStroke;
import java.awt.Color;
import java.awt.Font;
import java.awt.Graphics2D;
import java.awt.image.BufferedImage;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;
import java.nio.file.attribute.BasicFileAttributeView;
import java.nio.file.attribute.BasicFileAttributes;
import java.util.HashMap;
import java.util.Map;

import javax.imageio.ImageIO;
import javax.swing.JFrame;
import javax.swing.JScrollPane;
import javax.swing.JTable;
import javax.swing.table.JTableHeader;

import org.apache.commons.io.FileUtils;
import org.jfree.chart.ChartColor;
import org.jfree.chart.ChartFactory;
import org.jfree.chart.ChartUtilities;
import org.jfree.chart.JFreeChart;
import org.jfree.chart.axis.CategoryAxis;
import org.jfree.chart.axis.CategoryLabelPositions;
import org.jfree.chart.axis.ValueAxis;
import org.jfree.chart.plot.CategoryPlot;
import org.jfree.chart.plot.PlotOrientation;
import org.jfree.chart.renderer.category.LineAndShapeRenderer;
import org.jfree.chart.title.LegendTitle;
import org.jfree.chart.title.TextTitle;
import org.jfree.data.category.CategoryDataset;
import org.jfree.data.category.DefaultCategoryDataset;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.stereotype.Service;

import com.ebrain.api.entities.DataCheckResultWithBLOBs;
import com.ebrain.api.entities.ModelExplain;
import com.ebrain.api.exceptions.BaseException;
import com.ebrain.api.util.JsonUtil;
import com.google.gson.JsonArray;
import com.google.gson.JsonObject;

@Service
public class ChartService {
	private Logger logger = LoggerFactory.getLogger(ChartService.class);
	private String output=null;
	private Map<String,String> map=new HashMap<String,String>();
	
	
	/**
	 * 画折线图
	 * @param title
	 * @param xName
	 * @param yName
	 * @param width
	 * @param height
	 * @param dataset
	 * @param output
	 * @return
	 */
	public String drawBarChart(String title, String xName, String yName, int width, int height, CategoryDataset dataset,
			String output,PlotOrientation plotOrientation) {
		JFreeChart chart = ChartFactory.createBarChart(title, // 图表标题
				xName, // 目录轴的显示标签
				yName, // 数值轴的显示标签
				dataset, // 数据集
				plotOrientation, // 图表方向：水平、垂直
				true, // 是否显示图例(对于简单的柱状图必须是false)
				false, // 是否生成工具
				false // 是否生成URL链接
		);
		updateFont(chart);
		chart.setBackgroundPaint(ChartColor.WHITE);
		chart.getCategoryPlot().setBackgroundPaint(ChartColor.WHITE);
		chart.getCategoryPlot().setRangeGridlinePaint(ChartColor.GRAY);
		try {
			FileOutputStream fos_jpg = new FileOutputStream(output);
			ChartUtilities.writeChartAsJPEG(fos_jpg, 1, chart, width, height, null);
		} catch (IOException e) {
			e.printStackTrace();
		}
		return output;
	}

	/**
	 * 画柱状图
	 * @param title
	 * @param xName
	 * @param yName
	 * @param width
	 * @param height
	 * @param dataset
	 * @param output
	 * @return
	 */
	public String drawLineChart(String title, String xName, String yName, int width, int height,
			CategoryDataset dataset, String output) {
		JFreeChart chart = ChartFactory.createLineChart(title, // 图表标题
				xName, // X轴标签
				yName, // Y轴标签
				dataset, // 数据集
				PlotOrientation.VERTICAL, // 图表方向
				true, // 是否显示图例
				false, // 是否生成工具栏提示
				false); // 是否生成URL链接
		updateFont(chart);
		updatePlot(chart);
		chart.setBackgroundPaint(ChartColor.WHITE);
		try {
			FileOutputStream fos_jpg = new FileOutputStream(output);
			ChartUtilities.writeChartAsJPEG(fos_jpg, 1, chart, width, height, null);
		} catch (IOException e) {
			e.printStackTrace();
		}
		return output;
	}

	/**
	 * 画表格
	 * @param columnName
	 * @param rowData
	 * @param output
	 */
	public void drawTable(JsonObject dataCheckResultJson) {
		//dataCheckResultJson	=JsonUtil.toJsonObject("{\"file_size\":\"29K\",\"project\" : \"188850432192286720\",\"job\" : \"188850432481693696\",\"sequence\" : \"1\",\"separator\" : \",\",\"column_count\" : 15,\"validate_instance_count\" : 690,\"total_instance_count\" :690,\"except_instance_count\":0,\"total_value_count\" : 10350,\"feature_and_label\" : [{\"feature_name\" : \"Column_0\",\"column_index\" : 0,\"type\" : 0,\"value_count\" : 2,\"value_top_frequence\" : [{\"value\" : \"1\", \"frequence\" : 468},{\"value\" : \"0\", \"frequence\" : 222}]},{\"feature_name\" : \"Column_1\",\"column_index\" : 1,\"type\" : 1,\"value_count\" : 350,\"miss\" :0,\"max\" :80.25,\"min\" :0,\"mean\" :31.5682,\"std\" :1.85396,\"value_top_frequence\" : [{\"value\" : \"31.57\", \"frequence\" : 12},{\"value\" : \"22.67\", \"frequence\" : 9},{\"value\" : \"20.42\", \"frequence\" : 7},{\"value\" : \"18.83\", \"frequence\" : 6},{\"value\" : \"19.17\", \"frequence\" : 6},{\"value\" : \"20.67\", \"frequence\" : 6},{\"value\" : \"22.5\", \"frequence\" : 6},{\"value\" : \"23.58\", \"frequence\" : 6},{\"value\" : \"24.5\", \"frequence\" : 6},{\"value\" : \"25\", \"frequence\" : 6}]},{\"feature_name\" : \"Column_2\",\"column_index\" : 2,\"type\" : 1,\"value_count\" : 215,\"miss\" :0,\"max\" :28,\"min\" :0,\"mean\" :4.75872,\"std\" :0.198712,\"value_top_frequence\" : [{\"value\" : \"1.5\", \"frequence\" : 21},{\"value\" : \"0\", \"frequence\" : 19},{\"value\" : \"2.5\", \"frequence\" : 19},{\"value\" : \"3\", \"frequence\" : 19},{\"value\" : \"0.75\", \"frequence\" : 16},{\"value\" : \"1.25\", \"frequence\" : 16},{\"value\" : \"0.5\", \"frequence\" : 15},{\"value\" : \"5\", \"frequence\" : 14},{\"value\" : \"1.75\", \"frequence\" : 12},{\"value\" : \"4\", \"frequence\" : 12}]},{\"feature_name\" : \"Column_3\",\"column_index\" : 3,\"type\" : 0,\"value_count\" : 3,\"value_top_frequence\" : [{\"value\" : \"2\", \"frequence\" : 525},{\"value\" : \"1\", \"frequence\" : 163},{\"value\" : \"3\", \"frequence\" : 2}]},{\"feature_name\" : \"Column_4\",\"column_index\" : 4,\"type\" : 0,\"value_count\" : 14,\"value_top_frequence\" : [{\"value\" : \"8\", \"frequence\" : 146},{\"value\" : \"11\", \"frequence\" : 78},{\"value\" : \"9\", \"frequence\" : 64},{\"value\" : \"3\", \"frequence\" : 59},{\"value\" : \"6\", \"frequence\" : 54},{\"value\" : \"1\", \"frequence\" : 53},{\"value\" : \"4\", \"frequence\" : 51},{\"value\" : \"13\", \"frequence\" : 41},{\"value\" : \"14\", \"frequence\" : 38},{\"value\" : \"7\", \"frequence\" : 38}]},{\"feature_name\" : \"Column_5\",\"column_index\" : 5,\"type\" : 1,\"value_count\" : 8,\"miss\" :0,\"max\" :9,\"min\" :0,\"mean\" :4.69275,\"std\" :0.466094,\"value_top_frequence\" : [{\"value\" : \"4\", \"frequence\" : 408},{\"value\" : \"8\", \"frequence\" : 138},{\"value\" : \"5\", \"frequence\" : 59},{\"value\" : \"1\", \"frequence\" : 57},{\"value\" : \"3\", \"frequence\" : 8},{\"value\" : \"9\", \"frequence\" : 8},{\"value\" : \"2\", \"frequence\" : 6},{\"value\" : \"7\", \"frequence\" : 6}]},{\"feature_name\" : \"Column_6\",\"column_index\" : 6,\"type\" : 1,\"value_count\" : 132,\"miss\" :0,\"max\" :28.5,\"min\" :0,\"mean\" :2.22341,\"std\" :0.276172,\"value_top_frequence\" : [{\"value\" : \"0\", \"frequence\" : 70},{\"value\" : \"0.25\", \"frequence\" : 35},{\"value\" : \"0.04\", \"frequence\" : 33},{\"value\" : \"1\", \"frequence\" : 31},{\"value\" : \"0.125\", \"frequence\" : 30},{\"value\" : \"0.5\", \"frequence\" : 28},{\"value\" : \"0.08500\", \"frequence\" : 26},{\"value\" : \"1.5\", \"frequence\" : 25},{\"value\" : \"0.165\", \"frequence\" : 22},{\"value\" : \"2.5\", \"frequence\" : 17}]},{\"feature_name\" : \"Column_7\",\"column_index\" : 7,\"type\" : 0,\"value_count\" : 2,\"value_top_frequence\" : [{\"value\" : \"1\", \"frequence\" : 361},{\"value\" : \"0\", \"frequence\" : 329}]},{\"feature_name\" : \"Column_8\",\"column_index\" : 8,\"type\" : 0,\"value_count\" : 2,\"value_top_frequence\" : [{\"value\" : \"0\", \"frequence\" : 395},{\"value\" : \"1\", \"frequence\" : 295}]},{\"feature_name\" : \"Column_9\",\"column_index\" : 9,\"type\" : 1,\"value_count\" : 23,\"miss\" :0,\"max\" :67,\"min\" :0,\"mean\" :2.4,\"std\" :0.795162,\"value_top_frequence\" : [{\"value\" : \"0\", \"frequence\" : 395},{\"value\" : \"1\", \"frequence\" : 71},{\"value\" : \"2\", \"frequence\" : 45},{\"value\" : \"3\", \"frequence\" : 28},{\"value\" : \"6\", \"frequence\" : 23},{\"value\" : \"11\", \"frequence\" : 19},{\"value\" : \"5\", \"frequence\" : 18},{\"value\" : \"7\", \"frequence\" : 16},{\"value\" : \"4\", \"frequence\" : 15},{\"value\" : \"8\", \"frequence\" : 10}]},{\"feature_name\" : \"Column_10\",\"column_index\" : 10,\"type\" : 0,\"value_count\" : 2,\"value_top_frequence\" : [{\"value\" : \"0\", \"frequence\" : 374},{\"value\" : \"1\", \"frequence\" : 316}]},{\"feature_name\" : \"Column_11\",\"column_index\" : 11,\"type\" : 0,\"value_count\" : 3,\"value_top_frequence\" : [{\"value\" : \"2\", \"frequence\" : 625},{\"value\" : \"1\", \"frequence\" : 57},{\"value\" : \"3\", \"frequence\" : 8}]},{\"feature_name\" : \"Column_12\",\"column_index\" : 12,\"type\" : 1,\"value_count\" : 171,\"miss\" :0,\"max\" :2000,\"min\" :0,\"mean\" :184.014,\"std\" :3.24322,\"value_top_frequence\" : [{\"value\" : \"0\", \"frequence\" : 132},{\"value\" : \"120\", \"frequence\" : 35},{\"value\" : \"200\", \"frequence\" : 35},{\"value\" : \"160\", \"frequence\" : 34},{\"value\" : \"100\", \"frequence\" : 30},{\"value\" : \"80\", \"frequence\" : 30},{\"value\" : \"280\", \"frequence\" : 22},{\"value\" : \"180\", \"frequence\" : 18},{\"value\" : \"140\", \"frequence\" : 16},{\"value\" : \"240\", \"frequence\" : 14}]},{\"feature_name\" : \"Column_13\",\"column_index\" : 13,\"type\" : 1,\"value_count\" : 240,\"miss\" :0,\"max\" :100001,\"min\" :0,\"mean\" :1018.39,\"std\" :1.0666,\"value_top_frequence\" : [{\"value\" : \"1\", \"frequence\" : 295},{\"value\" : \"2\", \"frequence\" : 29},{\"value\" : \"1001\", \"frequence\" : 10},{\"value\" : \"501\", \"frequence\" : 10},{\"value\" : \"3\", \"frequence\" : 9},{\"value\" : \"301\", \"frequence\" : 8},{\"value\" : \"6\", \"frequence\" : 8},{\"value\" : \"7\", \"frequence\" : 8},{\"value\" : \"101\", \"frequence\" : 6},{\"value\" : \"201\", \"frequence\" : 6}]},{\"feature_name\" : \"Column_14\",\"column_index\" : 14,\"type\" : 0,\"value_count\" : 2,\"value_top_frequence\" : [{\"value\" : \"0\", \"frequence\" : 383},{\"value\" : \"1\", \"frequence\" : 307}]}]}");
		String[] columnName={"特征","特征类型","唯一个数","缺少情况","最大值","最小值","平均值","方差"};
		Object[][] rowData=null;
		String file=output+"\\table.jpg";
		map.put("table",output+"\\table.jpg");
		JsonArray feature_and_label = dataCheckResultJson.get("feature_and_label").getAsJsonArray();
		int type = feature_and_label.get(0).getAsJsonObject().get("type").getAsInt();
		if(type==0){
			if(rowData==null){
				rowData = new Object[feature_and_label.size()-1][8];
			}
			for(int i=1;i<feature_and_label.size();i++){
				
				JsonObject json = feature_and_label.get(i).getAsJsonObject();
				Object[] ss = new Object[8];
				if(json.has("feature_name")){
					ss[0]=json.get("feature_name").getAsString();
				}else{
					ss[0]="-";
				}
				if(json.has("type")){
					ss[1]=json.get("type").getAsString();
				}else{
					ss[1]="-";
				}
				if(json.has("value_count")){
					ss[2]=json.get("value_count").getAsString();
				}else{
					ss[2]="-";
				}
				if(json.has("miss")){
					ss[3]=json.get("miss").getAsString();
				}else{
					ss[3]="-";
				}
				if(json.has("max")){
					ss[4]=json.get("max").getAsString();
				}else{
					ss[4]="-";
				}
				if(json.has("min")){
					ss[5]=json.get("min").getAsString();
				}else{
					ss[5]="-";
				}
				if(json.has("mean")){
					ss[6]=json.get("mean").getAsString();
				}else{
					ss[6]="-";
				}
				if(json.has("std")){
					ss[7]=json.get("std").getAsString();
				}else{
					ss[7]="-";
				}
				rowData[i-1]=ss;
			}
		}
		JFrame f = new JFrame();
		f.setTitle("table");
		f.setLocationRelativeTo(null);
		JTable table = new JTable(rowData, columnName);
		table.setRowHeight(30);
		table.getTableHeader().setBackground(Color.LIGHT_GRAY);
		JScrollPane panel = new JScrollPane(table);
		f.add(panel);
		f.setDefaultCloseOperation(3);
		f.setSize(1024, table.getRowCount()*30+30);
		f.setResizable(false);
		f.pack();
		createImage(table,file);    
        if (f != null) {    
            f.dispose();    
        }    

     
	}
	public  void createImage(JTable table,String output) {    
        //get the table header component    
        JTableHeader tableHeaderComp = table.getTableHeader();    
        table.setAutoResizeMode(JTable.AUTO_RESIZE_OFF);
        int totalWidth = table.getPreferredSize().width;    
        int totalHeight = table.getPreferredSize().height;
        BufferedImage tableImage = new BufferedImage(totalWidth, totalHeight, BufferedImage.TYPE_INT_RGB);    
    
        Graphics2D g2D = (Graphics2D) tableImage.createGraphics();    
    
        g2D.setColor(Color.WHITE);    
        g2D.fillRect(0, 0, totalWidth, totalHeight);    
    
        g2D.translate(0, 0);    
        tableHeaderComp.paint(g2D);    
    
        g2D.translate(0, tableHeaderComp.getPreferredSize().height);    
        table.paint(g2D);    
    
        File f = new File(output);
 		try {
 			ImageIO.write(tableImage, "jpg", f);
 		} catch (IOException e) {
 			e.printStackTrace();
 		}
        g2D.dispose();    
    
    } 
	
	public String[] splitImage() throws IOException {  
	      
		String originalImg = "D:\\test\\pdf\\188850432192286720\\188850432481693696\\1\\lift_chart.jpg";

		// 读入大图
		File file = new File(originalImg);
		FileInputStream fis = new FileInputStream(file);
		BufferedImage image = ImageIO.read(fis);

		// 分割成4*4(16)个小图
		int rows = 4;
		int cols = 1;
		int chunks = rows * cols;

		// 计算每个小图的宽度和高度
		int chunkWidth = image.getWidth() / cols;
		int chunkHeight = image.getHeight() / rows;

		int count = 0;
		BufferedImage imgs[] = new BufferedImage[chunks];
		for (int x = 0; x < rows; x++) {
			for (int y = 0; y < cols; y++) {
				// 设置小图的大小和类型
				imgs[count] = new BufferedImage(chunkWidth,

						chunkHeight, image.getType());

				// 写入图像内容
				Graphics2D gr = imgs[count++].createGraphics();
				gr.drawImage(image, 0, 0, chunkWidth, chunkHeight, chunkWidth * y, chunkHeight * x,
						chunkWidth * y + chunkWidth, chunkHeight * x + chunkHeight, null);
				gr.dispose();
			}
		}
		String[] files= new String[imgs.length];
		// 输出小图
		for (int i = 0; i < imgs.length; i++) {
			files[i]="D:\\test\\pdf\\188850432192286720\\188850432481693696\\1\\" + i + ".jpg";
			ImageIO.write(imgs[i], "jpg",new File(files[i]));
		}

		System.out.println("完成分割！");
		return files;
	} 
	
	/**
	 * 设置图表字体
	 * @param chart
	 */
	public  void updateFont(JFreeChart chart) {
		// 标题
		TextTitle textTitle = chart.getTitle();
		textTitle.setFont(new Font("宋体", Font.PLAIN, 20));
		// 图表
		CategoryPlot categoryPlot = chart.getCategoryPlot();
		CategoryAxis categoryAxis = categoryPlot.getDomainAxis();
		// 设置图例
		LegendTitle legendTitle = chart.getLegend();
		legendTitle.setItemFont(new Font("宋体", Font.PLAIN, 16));
		// X轴字体
		categoryAxis.setTickLabelFont(new Font("宋体", Font.PLAIN, 14));
		// X轴标签字体
		categoryAxis.setLabelFont(new Font("宋体", Font.PLAIN, 14));
		// Y轴字体
		ValueAxis valueAxis = categoryPlot.getRangeAxis();
		valueAxis.setTickLabelFont(new Font("宋体", Font.PLAIN, 14));
		// Y轴标签字体
		valueAxis.setLabelFont(new Font("宋体", Font.PLAIN, 14));
	}

	/**
	 * 设置线条颜色
	 * @param chart
	 */
	public void updatePlot(JFreeChart chart) {
		// 分类图表
		CategoryPlot categroyPlot = chart.getCategoryPlot();
		categroyPlot.setBackgroundPaint(ChartColor.WHITE);
		categroyPlot.setRangeGridlinePaint(ChartColor.GRAY);
		CategoryAxis domainAxis = categroyPlot.getDomainAxis(); 
		domainAxis.setMaximumCategoryLabelLines(10);
		domainAxis.setCategoryLabelPositions(CategoryLabelPositions.UP_45);
		LineAndShapeRenderer renderer = (LineAndShapeRenderer) categroyPlot.getRenderer();
		// 设置显示颜色
		Color color1 = new Color(196,58,56);
		Color color2 = new Color(23,67,95);
		renderer.setSeriesPaint(0, color1);
		renderer.setSeriesPaint(1, color2);
		renderer.setSeriesStroke(0,new BasicStroke(3.0F,1,1,1.0F,new float[] {10F, 0F },1F));
		renderer.setSeriesStroke(1,new BasicStroke(3.0F,1,1,1.0F,new float[] {10F, 0F },1F));
	}

	
	public void drawFeatureImportanceChart(JsonObject dataCheckResultJson) throws BaseException{
		logger.debug("drawFeatureImportanceChart starting...");
		try{
	//		dataCheckResultJson	=JsonUtil.toJsonObject("{\"models\":[{\"model_name\":\"gbdt\",\"model_md5\":\"f325c228bc32111238e9b5c82de6edf2\",\"model_path\":\"/mnt/disk1/ebrain_web/ebrain_algo/188850432192286720/188850432481693696/1/gbdt/model/train_ins.model\",\"evalue_path\":\"/mnt/disk1/ebrain_web/ebrain_algo/188850432192286720/188850432481693696/1/gbdt/evaluate/train_ins.evaluate\",\"feature_importance\":[{\"feature_name\":\"Column_10_0\",\"contribution\":0.012250},{\"feature_name\":\"Column_3_1\",\"contribution\":0.021273},{\"feature_name\":\"Column_9\",\"contribution\":0.071547},{\"feature_name\":\"Column_8_0\",\"contribution\":0.073450},{\"feature_name\":\"Column_3_2\",\"contribution\":0.099013},{\"feature_name\":\"Column_4_8\",\"contribution\":0.123283},{\"feature_name\":\"Column_7_1\",\"contribution\":0.209240},{\"feature_name\":\"Column_4_3\",\"contribution\":0.255237},{\"feature_name\":\"Column_12\",\"contribution\":0.351802},{\"feature_name\":\"Column_4_6\",\"contribution\":0.900142},{\"feature_name\":\"Column_2\",\"contribution\":1.006700},{\"feature_name\":\"Column_13\",\"contribution\":1.363470},{\"feature_name\":\"Column_6\",\"contribution\":1.387640},{\"feature_name\":\"Column_4_11\",\"contribution\":1.689840},{\"feature_name\":\"Column_1\",\"contribution\":1.814310},{\"feature_name\":\"Column_5\",\"contribution\":2.768140}],\"roc\":{\"auc\":0.536327,\"x_y\":[{ \"x_value\":0,\"y_value\":0.0204082},{ \"x_value\":0.04,\"y_value\":0.0204082},{ \"x_value\":0.08,\"y_value\":0.0204082},{ \"x_value\":0.08,\"y_value\":0.0408163},{ \"x_value\":0.08,\"y_value\":0.0612245},{ \"x_value\":0.08,\"y_value\":0.0816327},{ \"x_value\":0.12,\"y_value\":0.0816327},{ \"x_value\":0.12,\"y_value\":0.102041},{ \"x_value\":0.12,\"y_value\":0.122449},{ \"x_value\":0.16,\"y_value\":0.122449},{ \"x_value\":0.16,\"y_value\":0.142857},{ \"x_value\":0.16,\"y_value\":0.163265},{ \"x_value\":0.2,\"y_value\":0.163265},{ \"x_value\":0.2,\"y_value\":0.183673},{ \"x_value\":0.2,\"y_value\":0.204082},{ \"x_value\":0.24,\"y_value\":0.204082},{ \"x_value\":0.28,\"y_value\":0.204082},{ \"x_value\":0.28,\"y_value\":0.22449},{ \"x_value\":0.28,\"y_value\":0.244898},{ \"x_value\":0.32,\"y_value\":0.244898},{ \"x_value\":0.32,\"y_value\":0.265306},{ \"x_value\":0.32,\"y_value\":0.285714},{ \"x_value\":0.36,\"y_value\":0.285714},{ \"x_value\":0.36,\"y_value\":0.306122},{ \"x_value\":0.36,\"y_value\":0.326531},{ \"x_value\":0.36,\"y_value\":0.346939},{ \"x_value\":0.36,\"y_value\":0.367347},{ \"x_value\":0.36,\"y_value\":0.387755},{ \"x_value\":0.36,\"y_value\":0.408163},{ \"x_value\":0.36,\"y_value\":0.428571},{ \"x_value\":0.4,\"y_value\":0.428571},{ \"x_value\":0.4,\"y_value\":0.44898},{ \"x_value\":0.4,\"y_value\":0.469388},{ \"x_value\":0.44,\"y_value\":0.469388},{ \"x_value\":0.44,\"y_value\":0.489796},{ \"x_value\":0.44,\"y_value\":0.510204},{ \"x_value\":0.48,\"y_value\":0.510204},{ \"x_value\":0.48,\"y_value\":0.530612},{ \"x_value\":0.52,\"y_value\":0.530612},{ \"x_value\":0.52,\"y_value\":0.55102},{ \"x_value\":0.56,\"y_value\":0.55102},{ \"x_value\":0.56,\"y_value\":0.571429},{ \"x_value\":0.56,\"y_value\":0.591837},{ \"x_value\":0.56,\"y_value\":0.612245},{ \"x_value\":0.56,\"y_value\":0.632653},{ \"x_value\":0.56,\"y_value\":0.653061},{ \"x_value\":0.56,\"y_value\":0.673469},{ \"x_value\":0.56,\"y_value\":0.693878},{ \"x_value\":0.56,\"y_value\":0.714286},{ \"x_value\":0.56,\"y_value\":0.734694},{ \"x_value\":0.56,\"y_value\":0.755102},{ \"x_value\":0.6,\"y_value\":0.755102},{ \"x_value\":0.64,\"y_value\":0.755102},{ \"x_value\":0.64,\"y_value\":0.77551},{ \"x_value\":0.64,\"y_value\":0.795918},{ \"x_value\":0.64,\"y_value\":0.816327},{ \"x_value\":0.68,\"y_value\":0.816327},{ \"x_value\":0.72,\"y_value\":0.836735},{ \"x_value\":0.76,\"y_value\":0.836735},{ \"x_value\":0.76,\"y_value\":0.857143},{ \"x_value\":0.76,\"y_value\":0.877551},{ \"x_value\":0.76,\"y_value\":0.897959},{ \"x_value\":0.8,\"y_value\":0.897959},{ \"x_value\":0.88,\"y_value\":0.897959},{ \"x_value\":0.88,\"y_value\":0.918367},{ \"x_value\":0.88,\"y_value\":0.938776},{ \"x_value\":0.88,\"y_value\":0.959184},{ \"x_value\":0.92,\"y_value\":0.959184},{ \"x_value\":0.96,\"y_value\":0.959184},{ \"x_value\":1,\"y_value\":0.959184},{ \"x_value\":1,\"y_value\":0.979592},{ \"x_value\":1,\"y_value\":1}]}, \"precise_recall\":{\"threshold\":0.400387,\"x_y\": [{\"precise\":0.657534, \"recall\":0.979592,\"pctr\":0.37782},{\"precise\":0.652778, \"recall\":0.959184,\"pctr\":0.37832},{\"precise\":0.661972, \"recall\":0.959184,\"pctr\":0.381605},{\"precise\":0.671429, \"recall\":0.959184,\"pctr\":0.396323},{\"precise\":0.681159, \"recall\":0.959184,\"pctr\":0.400387},{\"precise\":0.676471, \"recall\":0.938776,\"pctr\":0.407275},{\"precise\":0.671642, \"recall\":0.918367,\"pctr\":0.461631},{\"precise\":0.666667, \"recall\":0.897959,\"pctr\":0.469313},{\"precise\":0.6875, \"recall\":0.897959,\"pctr\":0.479892},{\"precise\":0.698413, \"recall\":0.897959,\"pctr\":0.485212},{\"precise\":0.693548, \"recall\":0.877551,\"pctr\":0.49577},{\"precise\":0.688525, \"recall\":0.857143,\"pctr\":0.541722},{\"precise\":0.683333, \"recall\":0.836735,\"pctr\":0.547141},{\"precise\":0.694915, \"recall\":0.836735,\"pctr\":0.551225},{\"precise\":0.701754, \"recall\":0.816327,\"pctr\":0.557888},{\"precise\":0.714286, \"recall\":0.816327,\"pctr\":0.564805},{\"precise\":0.709091, \"recall\":0.795918,\"pctr\":0.570137},{\"precise\":0.703704, \"recall\":0.77551,\"pctr\":0.570432},{\"precise\":0.698113, \"recall\":0.755102,\"pctr\":0.57242},{\"precise\":0.711538, \"recall\":0.755102,\"pctr\":0.618335},{\"precise\":0.72549, \"recall\":0.755102,\"pctr\":0.61837},{\"precise\":0.72, \"recall\":0.734694,\"pctr\":0.637246},{\"precise\":0.714286, \"recall\":0.714286,\"pctr\":0.63814},{\"precise\":0.708333, \"recall\":0.693878,\"pctr\":0.647823},{\"precise\":0.702128, \"recall\":0.673469,\"pctr\":0.662795},{\"precise\":0.695652, \"recall\":0.653061,\"pctr\":0.673188},{\"precise\":0.688889, \"recall\":0.632653,\"pctr\":0.675776},{\"precise\":0.681818, \"recall\":0.612245,\"pctr\":0.679484},{\"precise\":0.674419, \"recall\":0.591837,\"pctr\":0.680074},{\"precise\":0.666667, \"recall\":0.571429,\"pctr\":0.690871},{\"precise\":0.658537, \"recall\":0.55102,\"pctr\":0.699936},{\"precise\":0.675, \"recall\":0.55102,\"pctr\":0.70048},{\"precise\":0.666667, \"recall\":0.530612,\"pctr\":0.712758},{\"precise\":0.684211, \"recall\":0.530612,\"pctr\":0.716286},{\"precise\":0.675676, \"recall\":0.510204,\"pctr\":0.721316},{\"precise\":0.694444, \"recall\":0.510204,\"pctr\":0.722221},{\"precise\":0.685714, \"recall\":0.489796,\"pctr\":0.725274},{\"precise\":0.676471, \"recall\":0.469388,\"pctr\":0.725731},{\"precise\":0.69697, \"recall\":0.469388,\"pctr\":0.727227},{\"precise\":0.6875, \"recall\":0.44898,\"pctr\":0.73137},{\"precise\":0.677419, \"recall\":0.428571,\"pctr\":0.733386},{\"precise\":0.7, \"recall\":0.428571,\"pctr\":0.733978},{\"precise\":0.689655, \"recall\":0.408163,\"pctr\":0.734181},{\"precise\":0.678571, \"recall\":0.387755,\"pctr\":0.734697},{\"precise\":0.666667, \"recall\":0.367347,\"pctr\":0.738629},{\"precise\":0.653846, \"recall\":0.346939,\"pctr\":0.741727},{\"precise\":0.64, \"recall\":0.326531,\"pctr\":0.742114},{\"precise\":0.625, \"recall\":0.306122,\"pctr\":0.743503},{\"precise\":0.608696, \"recall\":0.285714,\"pctr\":0.747812},{\"precise\":0.636364, \"recall\":0.285714,\"pctr\":0.750835},{\"precise\":0.619048, \"recall\":0.265306,\"pctr\":0.7523},{\"precise\":0.6, \"recall\":0.244898,\"pctr\":0.756893},{\"precise\":0.631579, \"recall\":0.244898,\"pctr\":0.757837},{\"precise\":0.611111, \"recall\":0.22449,\"pctr\":0.758011},{\"precise\":0.588235, \"recall\":0.204082,\"pctr\":0.761057},{\"precise\":0.625, \"recall\":0.204082,\"pctr\":0.761485},{\"precise\":0.666667, \"recall\":0.204082,\"pctr\":0.767142},{\"precise\":0.642857, \"recall\":0.183673,\"pctr\":0.770279},{\"precise\":0.615385, \"recall\":0.163265,\"pctr\":0.770769},{\"precise\":0.666667, \"recall\":0.163265,\"pctr\":0.77091},{\"precise\":0.636364, \"recall\":0.142857,\"pctr\":0.771361},{\"precise\":0.6, \"recall\":0.122449,\"pctr\":0.7714},{\"precise\":0.666667, \"recall\":0.122449,\"pctr\":0.772949},{\"precise\":0.625, \"recall\":0.102041,\"pctr\":0.773744},{\"precise\":0.571429, \"recall\":0.0816327,\"pctr\":0.775432},{\"precise\":0.666667, \"recall\":0.0816327,\"pctr\":0.775589},{\"precise\":0.6, \"recall\":0.0612245,\"pctr\":0.780286},{\"precise\":0.5, \"recall\":0.0408163,\"pctr\":0.783307},{\"precise\":0.333333, \"recall\":0.0204082,\"pctr\":0.783679},{\"precise\":0.5, \"recall\":0.0204082,\"pctr\":0.784428},{\"precise\":1, \"recall\":0.0204082,\"pctr\":0.787467}] },\"confusion_matrix\":[[{\"value\":\"\"},{\"value\":\"1\"},{\"value\":\"0\"}],[{\"value\":\"1\"},{\"value\":\"47\", \"percent\":0.635135 },{\"value\":\"2\", \"percent\":0.027027}],[{\"value\":\"0\"},{\"value\":\"22\", \"percent\":0.297297 },{\"value\":\"3\", \"percent\":0.0405405}]],\"lift_chart\":[{\"label\":1, \"x_y\":[{\"x\":0.02, \"y\":1.5102, \"pctr\":0.787467},{\"x\":0.04, \"y\":0.755102, \"pctr\":0.784428},{\"x\":0.06, \"y\":1.13265, \"pctr\":0.783307},{\"x\":0.08, \"y\":1.20816, \"pctr\":0.780286},{\"x\":0.1, \"y\":1.07872, \"pctr\":0.775432},{\"x\":0.12, \"y\":1.13265, \"pctr\":0.773744},{\"x\":0.14, \"y\":1.05714, \"pctr\":0.7714},{\"x\":0.16, \"y\":1.09833, \"pctr\":0.771361},{\"x\":0.18, \"y\":1.04553, \"pctr\":0.770769},{\"x\":0.2, \"y\":1.07872, \"pctr\":0.770279},{\"x\":0.22, \"y\":0.943878, \"pctr\":0.761485},{\"x\":0.24, \"y\":0.977191, \"pctr\":0.761057},{\"x\":0.26, \"y\":0.953813, \"pctr\":0.757837},{\"x\":0.28, \"y\":0.981633, \"pctr\":0.756893},{\"x\":0.3, \"y\":0.961039, \"pctr\":0.750835},{\"x\":0.32, \"y\":0.984916, \"pctr\":0.747812},{\"x\":0.34, \"y\":1.02694, \"pctr\":0.742114},{\"x\":0.36, \"y\":1.04553, \"pctr\":0.741727},{\"x\":0.38, \"y\":1.07872, \"pctr\":0.734697},{\"x\":0.4, \"y\":1.0936, \"pctr\":0.734181},{\"x\":0.42, \"y\":1.07176, \"pctr\":0.733386},{\"x\":0.44, \"y\":1.08546, \"pctr\":0.73137},{\"x\":0.46, \"y\":1.06603, \"pctr\":0.725731},{\"x\":0.48, \"y\":1.07872, \"pctr\":0.725274},{\"x\":0.5, \"y\":1.06122, \"pctr\":0.721316},{\"x\":0.52, \"y\":1.0333, \"pctr\":0.716286},{\"x\":0.54, \"y\":1.04553, \"pctr\":0.712758},{\"x\":0.56, \"y\":1.03136, \"pctr\":0.699936},{\"x\":0.58, \"y\":1.04276, \"pctr\":0.690871},{\"x\":0.6, \"y\":1.06401, \"pctr\":0.679484},{\"x\":0.62, \"y\":1.07392, \"pctr\":0.675776},{\"x\":0.64, \"y\":1.09249, \"pctr\":0.662795},{\"x\":0.66, \"y\":1.10119, \"pctr\":0.647823},{\"x\":0.68, \"y\":1.11755, \"pctr\":0.637246},{\"x\":0.7, \"y\":1.09564, \"pctr\":0.61837},{\"x\":0.72, \"y\":1.08279, \"pctr\":0.57242},{\"x\":0.74, \"y\":1.0907, \"pctr\":0.570432},{\"x\":0.76, \"y\":1.07872, \"pctr\":0.564805},{\"x\":0.78, \"y\":1.08629, \"pctr\":0.557888},{\"x\":0.8, \"y\":1.04946, \"pctr\":0.551225},{\"x\":0.82, \"y\":1.05714, \"pctr\":0.547141},{\"x\":0.84, \"y\":1.07176, \"pctr\":0.49577},{\"x\":0.86, \"y\":1.05475, \"pctr\":0.485212},{\"x\":0.88, \"y\":1.02229, \"pctr\":0.479892},{\"x\":0.9, \"y\":1.02968, \"pctr\":0.469313},{\"x\":0.92, \"y\":1.04382, \"pctr\":0.407275},{\"x\":0.94, \"y\":1.02869, \"pctr\":0.400387},{\"x\":0.96, \"y\":0.999713, \"pctr\":0.381605},{\"x\":0.98, \"y\":1.0068, \"pctr\":0.37832},{\"x\":1, \"y\":0.489796, \"pctr\":0.725731}]}],\"ks\":[{\"label\":1, \"x_y\":[{\"x\":0.02, \"y_tpr\":0.0204082, \"y_fpr\":0,\"prop\":0.788329, \"diff\":0.0204082},{\"x\":0.04, \"y_tpr\":0.0204082, \"y_fpr\":0.04,\"prop\":0.787467, \"diff\":-0.0195918},{\"x\":0.06, \"y_tpr\":0.0408163, \"y_fpr\":0.08,\"prop\":0.783679, \"diff\":-0.0391837},{\"x\":0.08, \"y_tpr\":0.0612245, \"y_fpr\":0.08,\"prop\":0.783307, \"diff\":-0.0187755},{\"x\":0.1, \"y_tpr\":0.0816327, \"y_fpr\":0.12,\"prop\":0.775589, \"diff\":-0.0383673},{\"x\":0.12, \"y_tpr\":0.102041, \"y_fpr\":0.12,\"prop\":0.775432, \"diff\":-0.0179592},{\"x\":0.14, \"y_tpr\":0.122449, \"y_fpr\":0.16,\"prop\":0.772949, \"diff\":-0.037551},{\"x\":0.16, \"y_tpr\":0.142857, \"y_fpr\":0.16,\"prop\":0.7714, \"diff\":-0.0171429},{\"x\":0.18, \"y_tpr\":0.163265, \"y_fpr\":0.2,\"prop\":0.77091, \"diff\":-0.0367347},{\"x\":0.2, \"y_tpr\":0.183673, \"y_fpr\":0.2,\"prop\":0.770769, \"diff\":-0.0163265},{\"x\":0.22, \"y_tpr\":0.204082, \"y_fpr\":0.24,\"prop\":0.767142, \"diff\":-0.0359184},{\"x\":0.24, \"y_tpr\":0.204082, \"y_fpr\":0.28,\"prop\":0.761485, \"diff\":-0.0759184},{\"x\":0.26, \"y_tpr\":0.244898, \"y_fpr\":0.28,\"prop\":0.758011, \"diff\":-0.035102},{\"x\":0.28, \"y_tpr\":0.244898, \"y_fpr\":0.32,\"prop\":0.757837, \"diff\":-0.075102},{\"x\":0.3, \"y_tpr\":0.285714, \"y_fpr\":0.32,\"prop\":0.7523, \"diff\":-0.0342857},{\"x\":0.32, \"y_tpr\":0.285714, \"y_fpr\":0.36,\"prop\":0.750835, \"diff\":-0.0742857},{\"x\":0.34, \"y_tpr\":0.326531, \"y_fpr\":0.36,\"prop\":0.743503, \"diff\":-0.0334694},{\"x\":0.36, \"y_tpr\":0.346939, \"y_fpr\":0.36,\"prop\":0.742114, \"diff\":-0.0130612},{\"x\":0.38, \"y_tpr\":0.387755, \"y_fpr\":0.36,\"prop\":0.738629, \"diff\":0.0277551},{\"x\":0.4, \"y_tpr\":0.408163, \"y_fpr\":0.36,\"prop\":0.734697, \"diff\":0.0481633},{\"x\":0.42, \"y_tpr\":0.428571, \"y_fpr\":0.4,\"prop\":0.733978, \"diff\":0.0285714},{\"x\":0.44, \"y_tpr\":0.44898, \"y_fpr\":0.4,\"prop\":0.733386, \"diff\":0.0489796},{\"x\":0.46, \"y_tpr\":0.469388, \"y_fpr\":0.44,\"prop\":0.727227, \"diff\":0.0293878},{\"x\":0.48, \"y_tpr\":0.489796, \"y_fpr\":0.44,\"prop\":0.725731, \"diff\":0.0497959},{\"x\":0.5, \"y_tpr\":0.510204, \"y_fpr\":0.48,\"prop\":0.722221, \"diff\":0.0302041},{\"x\":0.52, \"y_tpr\":0.530612, \"y_fpr\":0.48,\"prop\":0.721316, \"diff\":0.0506122},{\"x\":0.54, \"y_tpr\":0.530612, \"y_fpr\":0.52,\"prop\":0.716286, \"diff\":0.0106122},{\"x\":0.56, \"y_tpr\":0.55102, \"y_fpr\":0.56,\"prop\":0.70048, \"diff\":-0.00897959},{\"x\":0.58, \"y_tpr\":0.571429, \"y_fpr\":0.56,\"prop\":0.699936, \"diff\":0.0114286},{\"x\":0.6, \"y_tpr\":0.612245, \"y_fpr\":0.56,\"prop\":0.680074, \"diff\":0.0522449},{\"x\":0.62, \"y_tpr\":0.632653, \"y_fpr\":0.56,\"prop\":0.679484, \"diff\":0.0726531},{\"x\":0.64, \"y_tpr\":0.673469, \"y_fpr\":0.56,\"prop\":0.673188, \"diff\":0.113469},{\"x\":0.66, \"y_tpr\":0.693878, \"y_fpr\":0.56,\"prop\":0.662795, \"diff\":0.133878},{\"x\":0.68, \"y_tpr\":0.734694, \"y_fpr\":0.56,\"prop\":0.63814, \"diff\":0.174694},{\"x\":0.7, \"y_tpr\":0.755102, \"y_fpr\":0.56,\"prop\":0.637246, \"diff\":0.195102, \"key_value\":1},{\"x\":0.72, \"y_tpr\":0.755102, \"y_fpr\":0.64,\"prop\":0.618335, \"diff\":0.115102},{\"x\":0.74, \"y_tpr\":0.77551, \"y_fpr\":0.64,\"prop\":0.57242, \"diff\":0.13551},{\"x\":0.76, \"y_tpr\":0.816327, \"y_fpr\":0.64,\"prop\":0.570137, \"diff\":0.176327},{\"x\":0.78, \"y_tpr\":0.816327, \"y_fpr\":0.68,\"prop\":0.564805, \"diff\":0.136327},{\"x\":0.8, \"y_tpr\":0.836735, \"y_fpr\":0.72,\"prop\":0.557888, \"diff\":0.116735},{\"x\":0.82, \"y_tpr\":0.836735, \"y_fpr\":0.76,\"prop\":0.551225, \"diff\":0.0767347},{\"x\":0.84, \"y_tpr\":0.877551, \"y_fpr\":0.76,\"prop\":0.541722, \"diff\":0.117551},{\"x\":0.86, \"y_tpr\":0.897959, \"y_fpr\":0.76,\"prop\":0.49577, \"diff\":0.137959},{\"x\":0.88, \"y_tpr\":0.897959, \"y_fpr\":0.88,\"prop\":0.479892, \"diff\":0.0179592},{\"x\":0.9, \"y_tpr\":0.897959, \"y_fpr\":0.88,\"prop\":0.479892, \"diff\":0.0179592},{\"x\":0.92, \"y_tpr\":0.938776, \"y_fpr\":0.88,\"prop\":0.461631, \"diff\":0.0587755},{\"x\":0.94, \"y_tpr\":0.959184, \"y_fpr\":0.88,\"prop\":0.407275, \"diff\":0.0791837},{\"x\":0.96, \"y_tpr\":0.959184, \"y_fpr\":0.96,\"prop\":0.396323, \"diff\":-0.000816327},{\"x\":0.98, \"y_tpr\":0.959184, \"y_fpr\":1,\"prop\":0.381605, \"diff\":-0.0408163},{\"x\":1, \"y_tpr\":1, \"y_fpr\":1,\"prop\":0.37782, \"diff\":0}]}]}]}");
			DefaultCategoryDataset dataset = new DefaultCategoryDataset();
			
			JsonObject model = dataCheckResultJson.get("models").getAsJsonArray().get(0).getAsJsonObject();
			JsonArray feature_importance = model.get("feature_importance").getAsJsonArray();
			
			for(int i=0;i<feature_importance.size();i++){
				if(i>10){
					break;
				}
				JsonObject obj = feature_importance.get(i).getAsJsonObject();
				dataset.addValue(obj.get("contribution").getAsFloat(),"",obj.get("feature_name").getAsString());
			}
			drawBarChart("特征重要性", "特征数量", "特征名", 650, 450, dataset, output+"\\feature_importance_chart.jpg",PlotOrientation.HORIZONTAL);
			map.put("feature_importance_chart",output+"\\feature_importance_chart.jpg");
		} catch (Exception e) {
			throw new BaseException(1,"数据错误");
		}
	}
	/**
	 * 特征图
	 * @param dataCheckResultJson
	 */
 	public void drawFeatureChart(JsonObject dataCheckResultJson) throws BaseException{
 		logger.debug("drawFeatureChart starting...");
 		try{
		//	dataCheckResultJson = JsonUtil.toJsonObject("{\"file_size\":\"29K\",\"project\" : \"188850432192286720\",\"job\" : \"188850432481693696\",\"sequence\" : \"1\",\"separator\" : \",\",\"column_count\" : 15,\"validate_instance_count\" : 690,\"total_instance_count\" :690,\"except_instance_count\":0,\"total_value_count\" : 10350,\"feature_and_label\" : [{\"feature_name\" : \"Column_0\",\"column_index\" : 0,\"type\" : 0,\"value_count\" : 2,\"value_top_frequence\" : [{\"value\" : \"1\", \"frequence\" : 468},{\"value\" : \"0\", \"frequence\" : 222}]},{\"feature_name\" : \"Column_1\",\"column_index\" : 1,\"type\" : 1,\"value_count\" : 350,\"miss\" :0,\"max\" :80.25,\"min\" :0,\"mean\" :31.5682,\"std\" :1.85396,\"value_top_frequence\" : [{\"value\" : \"31.57\", \"frequence\" : 12},{\"value\" : \"22.67\", \"frequence\" : 9},{\"value\" : \"20.42\", \"frequence\" : 7},{\"value\" : \"18.83\", \"frequence\" : 6},{\"value\" : \"19.17\", \"frequence\" : 6},{\"value\" : \"20.67\", \"frequence\" : 6},{\"value\" : \"22.5\", \"frequence\" : 6},{\"value\" : \"23.58\", \"frequence\" : 6},{\"value\" : \"24.5\", \"frequence\" : 6},{\"value\" : \"25\", \"frequence\" : 6}]},{\"feature_name\" : \"Column_2\",\"column_index\" : 2,\"type\" : 1,\"value_count\" : 215,\"miss\" :0,\"max\" :28,\"min\" :0,\"mean\" :4.75872,\"std\" :0.198712,\"value_top_frequence\" : [{\"value\" : \"1.5\", \"frequence\" : 21},{\"value\" : \"0\", \"frequence\" : 19},{\"value\" : \"2.5\", \"frequence\" : 19},{\"value\" : \"3\", \"frequence\" : 19},{\"value\" : \"0.75\", \"frequence\" : 16},{\"value\" : \"1.25\", \"frequence\" : 16},{\"value\" : \"0.5\", \"frequence\" : 15},{\"value\" : \"5\", \"frequence\" : 14},{\"value\" : \"1.75\", \"frequence\" : 12},{\"value\" : \"4\", \"frequence\" : 12}]},{\"feature_name\" : \"Column_3\",\"column_index\" : 3,\"type\" : 0,\"value_count\" : 3,\"value_top_frequence\" : [{\"value\" : \"2\", \"frequence\" : 525},{\"value\" : \"1\", \"frequence\" : 163},{\"value\" : \"3\", \"frequence\" : 2}]},{\"feature_name\" : \"Column_4\",\"column_index\" : 4,\"type\" : 0,\"value_count\" : 14,\"value_top_frequence\" : [{\"value\" : \"8\", \"frequence\" : 146},{\"value\" : \"11\", \"frequence\" : 78},{\"value\" : \"9\", \"frequence\" : 64},{\"value\" : \"3\", \"frequence\" : 59},{\"value\" : \"6\", \"frequence\" : 54},{\"value\" : \"1\", \"frequence\" : 53},{\"value\" : \"4\", \"frequence\" : 51},{\"value\" : \"13\", \"frequence\" : 41},{\"value\" : \"14\", \"frequence\" : 38},{\"value\" : \"7\", \"frequence\" : 38}]},{\"feature_name\" : \"Column_5\",\"column_index\" : 5,\"type\" : 1,\"value_count\" : 8,\"miss\" :0,\"max\" :9,\"min\" :0,\"mean\" :4.69275,\"std\" :0.466094,\"value_top_frequence\" : [{\"value\" : \"4\", \"frequence\" : 408},{\"value\" : \"8\", \"frequence\" : 138},{\"value\" : \"5\", \"frequence\" : 59},{\"value\" : \"1\", \"frequence\" : 57},{\"value\" : \"3\", \"frequence\" : 8},{\"value\" : \"9\", \"frequence\" : 8},{\"value\" : \"2\", \"frequence\" : 6},{\"value\" : \"7\", \"frequence\" : 6}]},{\"feature_name\" : \"Column_6\",\"column_index\" : 6,\"type\" : 1,\"value_count\" : 132,\"miss\" :0,\"max\" :28.5,\"min\" :0,\"mean\" :2.22341,\"std\" :0.276172,\"value_top_frequence\" : [{\"value\" : \"0\", \"frequence\" : 70},{\"value\" : \"0.25\", \"frequence\" : 35},{\"value\" : \"0.04\", \"frequence\" : 33},{\"value\" : \"1\", \"frequence\" : 31},{\"value\" : \"0.125\", \"frequence\" : 30},{\"value\" : \"0.5\", \"frequence\" : 28},{\"value\" : \"0.08500\", \"frequence\" : 26},{\"value\" : \"1.5\", \"frequence\" : 25},{\"value\" : \"0.165\", \"frequence\" : 22},{\"value\" : \"2.5\", \"frequence\" : 17}]},{\"feature_name\" : \"Column_7\",\"column_index\" : 7,\"type\" : 0,\"value_count\" : 2,\"value_top_frequence\" : [{\"value\" : \"1\", \"frequence\" : 361},{\"value\" : \"0\", \"frequence\" : 329}]},{\"feature_name\" : \"Column_8\",\"column_index\" : 8,\"type\" : 0,\"value_count\" : 2,\"value_top_frequence\" : [{\"value\" : \"0\", \"frequence\" : 395},{\"value\" : \"1\", \"frequence\" : 295}]},{\"feature_name\" : \"Column_9\",\"column_index\" : 9,\"type\" : 1,\"value_count\" : 23,\"miss\" :0,\"max\" :67,\"min\" :0,\"mean\" :2.4,\"std\" :0.795162,\"value_top_frequence\" : [{\"value\" : \"0\", \"frequence\" : 395},{\"value\" : \"1\", \"frequence\" : 71},{\"value\" : \"2\", \"frequence\" : 45},{\"value\" : \"3\", \"frequence\" : 28},{\"value\" : \"6\", \"frequence\" : 23},{\"value\" : \"11\", \"frequence\" : 19},{\"value\" : \"5\", \"frequence\" : 18},{\"value\" : \"7\", \"frequence\" : 16},{\"value\" : \"4\", \"frequence\" : 15},{\"value\" : \"8\", \"frequence\" : 10}]},{\"feature_name\" : \"Column_10\",\"column_index\" : 10,\"type\" : 0,\"value_count\" : 2,\"value_top_frequence\" : [{\"value\" : \"0\", \"frequence\" : 374},{\"value\" : \"1\", \"frequence\" : 316}]},{\"feature_name\" : \"Column_11\",\"column_index\" : 11,\"type\" : 0,\"value_count\" : 3,\"value_top_frequence\" : [{\"value\" : \"2\", \"frequence\" : 625},{\"value\" : \"1\", \"frequence\" : 57},{\"value\" : \"3\", \"frequence\" : 8}]},{\"feature_name\" : \"Column_12\",\"column_index\" : 12,\"type\" : 1,\"value_count\" : 171,\"miss\" :0,\"max\" :2000,\"min\" :0,\"mean\" :184.014,\"std\" :3.24322,\"value_top_frequence\" : [{\"value\" : \"0\", \"frequence\" : 132},{\"value\" : \"120\", \"frequence\" : 35},{\"value\" : \"200\", \"frequence\" : 35},{\"value\" : \"160\", \"frequence\" : 34},{\"value\" : \"100\", \"frequence\" : 30},{\"value\" : \"80\", \"frequence\" : 30},{\"value\" : \"280\", \"frequence\" : 22},{\"value\" : \"180\", \"frequence\" : 18},{\"value\" : \"140\", \"frequence\" : 16},{\"value\" : \"240\", \"frequence\" : 14}]},{\"feature_name\" : \"Column_13\",\"column_index\" : 13,\"type\" : 1,\"value_count\" : 240,\"miss\" :0,\"max\" :100001,\"min\" :0,\"mean\" :1018.39,\"std\" :1.0666,\"value_top_frequence\" : [{\"value\" : \"1\", \"frequence\" : 295},{\"value\" : \"2\", \"frequence\" : 29},{\"value\" : \"1001\", \"frequence\" : 10},{\"value\" : \"501\", \"frequence\" : 10},{\"value\" : \"3\", \"frequence\" : 9},{\"value\" : \"301\", \"frequence\" : 8},{\"value\" : \"6\", \"frequence\" : 8},{\"value\" : \"7\", \"frequence\" : 8},{\"value\" : \"101\", \"frequence\" : 6},{\"value\" : \"201\", \"frequence\" : 6}]},{\"feature_name\" : \"Column_14\",\"column_index\" : 14,\"type\" : 0,\"value_count\" : 2,\"value_top_frequence\" : [{\"value\" : \"0\", \"frequence\" : 383},{\"value\" : \"1\", \"frequence\" : 307}]}]}");
			DefaultCategoryDataset dataset = new DefaultCategoryDataset();
			JsonObject gefeature_and_label = dataCheckResultJson.get("feature_and_label").getAsJsonArray().get(0).getAsJsonObject();
			JsonArray value_top_frequence = gefeature_and_label.get("value_top_frequence").getAsJsonArray();
			for(int i=0;i<value_top_frequence.size();i++){
				JsonObject obj = value_top_frequence.get(i).getAsJsonObject();
				dataset.addValue(obj.get("frequence").getAsLong(),obj.get("value").getAsString(),"");
			}
			drawBarChart("特征分布", "目标类型", "样本数", 650, 450, dataset, output+"\\feature_chart.jpg",PlotOrientation.VERTICAL);
			map.put("feature_chart",output+"\\feature_chart.jpg");
 		} catch (Exception e) {
			throw new BaseException(1,"数据错误");
		}
	}
	
	public void drawLiftChart(JsonObject modelExplainJson) throws BaseException{
		try {
			logger.debug("drawLiftChart starting...");
		//	dataCheckResultJson	=JsonUtil.toJsonObject("{\"models\":[{\"model_name\":\"gbdt\",\"model_md5\":\"f325c228bc32111238e9b5c82de6edf2\",\"model_path\":\"/mnt/disk1/ebrain_web/ebrain_algo/188850432192286720/188850432481693696/1/gbdt/model/train_ins.model\",\"evalue_path\":\"/mnt/disk1/ebrain_web/ebrain_algo/188850432192286720/188850432481693696/1/gbdt/evaluate/train_ins.evaluate\",\"feature_importance\":[{\"feature_name\":\"Column_10_0\",\"contribution\":0.012250},{\"feature_name\":\"Column_3_1\",\"contribution\":0.021273},{\"feature_name\":\"Column_9\",\"contribution\":0.071547},{\"feature_name\":\"Column_8_0\",\"contribution\":0.073450},{\"feature_name\":\"Column_3_2\",\"contribution\":0.099013},{\"feature_name\":\"Column_4_8\",\"contribution\":0.123283},{\"feature_name\":\"Column_7_1\",\"contribution\":0.209240},{\"feature_name\":\"Column_4_3\",\"contribution\":0.255237},{\"feature_name\":\"Column_12\",\"contribution\":0.351802},{\"feature_name\":\"Column_4_6\",\"contribution\":0.900142},{\"feature_name\":\"Column_2\",\"contribution\":1.006700},{\"feature_name\":\"Column_13\",\"contribution\":1.363470},{\"feature_name\":\"Column_6\",\"contribution\":1.387640},{\"feature_name\":\"Column_4_11\",\"contribution\":1.689840},{\"feature_name\":\"Column_1\",\"contribution\":1.814310},{\"feature_name\":\"Column_5\",\"contribution\":2.768140}],\"roc\":{\"auc\":0.536327,\"x_y\":[{ \"x_value\":0,\"y_value\":0.0204082},{ \"x_value\":0.04,\"y_value\":0.0204082},{ \"x_value\":0.08,\"y_value\":0.0204082},{ \"x_value\":0.08,\"y_value\":0.0408163},{ \"x_value\":0.08,\"y_value\":0.0612245},{ \"x_value\":0.08,\"y_value\":0.0816327},{ \"x_value\":0.12,\"y_value\":0.0816327},{ \"x_value\":0.12,\"y_value\":0.102041},{ \"x_value\":0.12,\"y_value\":0.122449},{ \"x_value\":0.16,\"y_value\":0.122449},{ \"x_value\":0.16,\"y_value\":0.142857},{ \"x_value\":0.16,\"y_value\":0.163265},{ \"x_value\":0.2,\"y_value\":0.163265},{ \"x_value\":0.2,\"y_value\":0.183673},{ \"x_value\":0.2,\"y_value\":0.204082},{ \"x_value\":0.24,\"y_value\":0.204082},{ \"x_value\":0.28,\"y_value\":0.204082},{ \"x_value\":0.28,\"y_value\":0.22449},{ \"x_value\":0.28,\"y_value\":0.244898},{ \"x_value\":0.32,\"y_value\":0.244898},{ \"x_value\":0.32,\"y_value\":0.265306},{ \"x_value\":0.32,\"y_value\":0.285714},{ \"x_value\":0.36,\"y_value\":0.285714},{ \"x_value\":0.36,\"y_value\":0.306122},{ \"x_value\":0.36,\"y_value\":0.326531},{ \"x_value\":0.36,\"y_value\":0.346939},{ \"x_value\":0.36,\"y_value\":0.367347},{ \"x_value\":0.36,\"y_value\":0.387755},{ \"x_value\":0.36,\"y_value\":0.408163},{ \"x_value\":0.36,\"y_value\":0.428571},{ \"x_value\":0.4,\"y_value\":0.428571},{ \"x_value\":0.4,\"y_value\":0.44898},{ \"x_value\":0.4,\"y_value\":0.469388},{ \"x_value\":0.44,\"y_value\":0.469388},{ \"x_value\":0.44,\"y_value\":0.489796},{ \"x_value\":0.44,\"y_value\":0.510204},{ \"x_value\":0.48,\"y_value\":0.510204},{ \"x_value\":0.48,\"y_value\":0.530612},{ \"x_value\":0.52,\"y_value\":0.530612},{ \"x_value\":0.52,\"y_value\":0.55102},{ \"x_value\":0.56,\"y_value\":0.55102},{ \"x_value\":0.56,\"y_value\":0.571429},{ \"x_value\":0.56,\"y_value\":0.591837},{ \"x_value\":0.56,\"y_value\":0.612245},{ \"x_value\":0.56,\"y_value\":0.632653},{ \"x_value\":0.56,\"y_value\":0.653061},{ \"x_value\":0.56,\"y_value\":0.673469},{ \"x_value\":0.56,\"y_value\":0.693878},{ \"x_value\":0.56,\"y_value\":0.714286},{ \"x_value\":0.56,\"y_value\":0.734694},{ \"x_value\":0.56,\"y_value\":0.755102},{ \"x_value\":0.6,\"y_value\":0.755102},{ \"x_value\":0.64,\"y_value\":0.755102},{ \"x_value\":0.64,\"y_value\":0.77551},{ \"x_value\":0.64,\"y_value\":0.795918},{ \"x_value\":0.64,\"y_value\":0.816327},{ \"x_value\":0.68,\"y_value\":0.816327},{ \"x_value\":0.72,\"y_value\":0.836735},{ \"x_value\":0.76,\"y_value\":0.836735},{ \"x_value\":0.76,\"y_value\":0.857143},{ \"x_value\":0.76,\"y_value\":0.877551},{ \"x_value\":0.76,\"y_value\":0.897959},{ \"x_value\":0.8,\"y_value\":0.897959},{ \"x_value\":0.88,\"y_value\":0.897959},{ \"x_value\":0.88,\"y_value\":0.918367},{ \"x_value\":0.88,\"y_value\":0.938776},{ \"x_value\":0.88,\"y_value\":0.959184},{ \"x_value\":0.92,\"y_value\":0.959184},{ \"x_value\":0.96,\"y_value\":0.959184},{ \"x_value\":1,\"y_value\":0.959184},{ \"x_value\":1,\"y_value\":0.979592},{ \"x_value\":1,\"y_value\":1}]}, \"precise_recall\":{\"threshold\":0.400387,\"x_y\": [{\"precise\":0.657534, \"recall\":0.979592,\"pctr\":0.37782},{\"precise\":0.652778, \"recall\":0.959184,\"pctr\":0.37832},{\"precise\":0.661972, \"recall\":0.959184,\"pctr\":0.381605},{\"precise\":0.671429, \"recall\":0.959184,\"pctr\":0.396323},{\"precise\":0.681159, \"recall\":0.959184,\"pctr\":0.400387},{\"precise\":0.676471, \"recall\":0.938776,\"pctr\":0.407275},{\"precise\":0.671642, \"recall\":0.918367,\"pctr\":0.461631},{\"precise\":0.666667, \"recall\":0.897959,\"pctr\":0.469313},{\"precise\":0.6875, \"recall\":0.897959,\"pctr\":0.479892},{\"precise\":0.698413, \"recall\":0.897959,\"pctr\":0.485212},{\"precise\":0.693548, \"recall\":0.877551,\"pctr\":0.49577},{\"precise\":0.688525, \"recall\":0.857143,\"pctr\":0.541722},{\"precise\":0.683333, \"recall\":0.836735,\"pctr\":0.547141},{\"precise\":0.694915, \"recall\":0.836735,\"pctr\":0.551225},{\"precise\":0.701754, \"recall\":0.816327,\"pctr\":0.557888},{\"precise\":0.714286, \"recall\":0.816327,\"pctr\":0.564805},{\"precise\":0.709091, \"recall\":0.795918,\"pctr\":0.570137},{\"precise\":0.703704, \"recall\":0.77551,\"pctr\":0.570432},{\"precise\":0.698113, \"recall\":0.755102,\"pctr\":0.57242},{\"precise\":0.711538, \"recall\":0.755102,\"pctr\":0.618335},{\"precise\":0.72549, \"recall\":0.755102,\"pctr\":0.61837},{\"precise\":0.72, \"recall\":0.734694,\"pctr\":0.637246},{\"precise\":0.714286, \"recall\":0.714286,\"pctr\":0.63814},{\"precise\":0.708333, \"recall\":0.693878,\"pctr\":0.647823},{\"precise\":0.702128, \"recall\":0.673469,\"pctr\":0.662795},{\"precise\":0.695652, \"recall\":0.653061,\"pctr\":0.673188},{\"precise\":0.688889, \"recall\":0.632653,\"pctr\":0.675776},{\"precise\":0.681818, \"recall\":0.612245,\"pctr\":0.679484},{\"precise\":0.674419, \"recall\":0.591837,\"pctr\":0.680074},{\"precise\":0.666667, \"recall\":0.571429,\"pctr\":0.690871},{\"precise\":0.658537, \"recall\":0.55102,\"pctr\":0.699936},{\"precise\":0.675, \"recall\":0.55102,\"pctr\":0.70048},{\"precise\":0.666667, \"recall\":0.530612,\"pctr\":0.712758},{\"precise\":0.684211, \"recall\":0.530612,\"pctr\":0.716286},{\"precise\":0.675676, \"recall\":0.510204,\"pctr\":0.721316},{\"precise\":0.694444, \"recall\":0.510204,\"pctr\":0.722221},{\"precise\":0.685714, \"recall\":0.489796,\"pctr\":0.725274},{\"precise\":0.676471, \"recall\":0.469388,\"pctr\":0.725731},{\"precise\":0.69697, \"recall\":0.469388,\"pctr\":0.727227},{\"precise\":0.6875, \"recall\":0.44898,\"pctr\":0.73137},{\"precise\":0.677419, \"recall\":0.428571,\"pctr\":0.733386},{\"precise\":0.7, \"recall\":0.428571,\"pctr\":0.733978},{\"precise\":0.689655, \"recall\":0.408163,\"pctr\":0.734181},{\"precise\":0.678571, \"recall\":0.387755,\"pctr\":0.734697},{\"precise\":0.666667, \"recall\":0.367347,\"pctr\":0.738629},{\"precise\":0.653846, \"recall\":0.346939,\"pctr\":0.741727},{\"precise\":0.64, \"recall\":0.326531,\"pctr\":0.742114},{\"precise\":0.625, \"recall\":0.306122,\"pctr\":0.743503},{\"precise\":0.608696, \"recall\":0.285714,\"pctr\":0.747812},{\"precise\":0.636364, \"recall\":0.285714,\"pctr\":0.750835},{\"precise\":0.619048, \"recall\":0.265306,\"pctr\":0.7523},{\"precise\":0.6, \"recall\":0.244898,\"pctr\":0.756893},{\"precise\":0.631579, \"recall\":0.244898,\"pctr\":0.757837},{\"precise\":0.611111, \"recall\":0.22449,\"pctr\":0.758011},{\"precise\":0.588235, \"recall\":0.204082,\"pctr\":0.761057},{\"precise\":0.625, \"recall\":0.204082,\"pctr\":0.761485},{\"precise\":0.666667, \"recall\":0.204082,\"pctr\":0.767142},{\"precise\":0.642857, \"recall\":0.183673,\"pctr\":0.770279},{\"precise\":0.615385, \"recall\":0.163265,\"pctr\":0.770769},{\"precise\":0.666667, \"recall\":0.163265,\"pctr\":0.77091},{\"precise\":0.636364, \"recall\":0.142857,\"pctr\":0.771361},{\"precise\":0.6, \"recall\":0.122449,\"pctr\":0.7714},{\"precise\":0.666667, \"recall\":0.122449,\"pctr\":0.772949},{\"precise\":0.625, \"recall\":0.102041,\"pctr\":0.773744},{\"precise\":0.571429, \"recall\":0.0816327,\"pctr\":0.775432},{\"precise\":0.666667, \"recall\":0.0816327,\"pctr\":0.775589},{\"precise\":0.6, \"recall\":0.0612245,\"pctr\":0.780286},{\"precise\":0.5, \"recall\":0.0408163,\"pctr\":0.783307},{\"precise\":0.333333, \"recall\":0.0204082,\"pctr\":0.783679},{\"precise\":0.5, \"recall\":0.0204082,\"pctr\":0.784428},{\"precise\":1, \"recall\":0.0204082,\"pctr\":0.787467}] },\"confusion_matrix\":[[{\"value\":\"\"},{\"value\":\"1\"},{\"value\":\"0\"}],[{\"value\":\"1\"},{\"value\":\"47\", \"percent\":0.635135 },{\"value\":\"2\", \"percent\":0.027027}],[{\"value\":\"0\"},{\"value\":\"22\", \"percent\":0.297297 },{\"value\":\"3\", \"percent\":0.0405405}]],\"lift_chart\":[{\"label\":1, \"x_y\":[{\"x\":0.02, \"y\":1.5102, \"pctr\":0.787467},{\"x\":0.04, \"y\":0.755102, \"pctr\":0.784428},{\"x\":0.06, \"y\":1.13265, \"pctr\":0.783307},{\"x\":0.08, \"y\":1.20816, \"pctr\":0.780286},{\"x\":0.1, \"y\":1.07872, \"pctr\":0.775432},{\"x\":0.12, \"y\":1.13265, \"pctr\":0.773744},{\"x\":0.14, \"y\":1.05714, \"pctr\":0.7714},{\"x\":0.16, \"y\":1.09833, \"pctr\":0.771361},{\"x\":0.18, \"y\":1.04553, \"pctr\":0.770769},{\"x\":0.2, \"y\":1.07872, \"pctr\":0.770279},{\"x\":0.22, \"y\":0.943878, \"pctr\":0.761485},{\"x\":0.24, \"y\":0.977191, \"pctr\":0.761057},{\"x\":0.26, \"y\":0.953813, \"pctr\":0.757837},{\"x\":0.28, \"y\":0.981633, \"pctr\":0.756893},{\"x\":0.3, \"y\":0.961039, \"pctr\":0.750835},{\"x\":0.32, \"y\":0.984916, \"pctr\":0.747812},{\"x\":0.34, \"y\":1.02694, \"pctr\":0.742114},{\"x\":0.36, \"y\":1.04553, \"pctr\":0.741727},{\"x\":0.38, \"y\":1.07872, \"pctr\":0.734697},{\"x\":0.4, \"y\":1.0936, \"pctr\":0.734181},{\"x\":0.42, \"y\":1.07176, \"pctr\":0.733386},{\"x\":0.44, \"y\":1.08546, \"pctr\":0.73137},{\"x\":0.46, \"y\":1.06603, \"pctr\":0.725731},{\"x\":0.48, \"y\":1.07872, \"pctr\":0.725274},{\"x\":0.5, \"y\":1.06122, \"pctr\":0.721316},{\"x\":0.52, \"y\":1.0333, \"pctr\":0.716286},{\"x\":0.54, \"y\":1.04553, \"pctr\":0.712758},{\"x\":0.56, \"y\":1.03136, \"pctr\":0.699936},{\"x\":0.58, \"y\":1.04276, \"pctr\":0.690871},{\"x\":0.6, \"y\":1.06401, \"pctr\":0.679484},{\"x\":0.62, \"y\":1.07392, \"pctr\":0.675776},{\"x\":0.64, \"y\":1.09249, \"pctr\":0.662795},{\"x\":0.66, \"y\":1.10119, \"pctr\":0.647823},{\"x\":0.68, \"y\":1.11755, \"pctr\":0.637246},{\"x\":0.7, \"y\":1.09564, \"pctr\":0.61837},{\"x\":0.72, \"y\":1.08279, \"pctr\":0.57242},{\"x\":0.74, \"y\":1.0907, \"pctr\":0.570432},{\"x\":0.76, \"y\":1.07872, \"pctr\":0.564805},{\"x\":0.78, \"y\":1.08629, \"pctr\":0.557888},{\"x\":0.8, \"y\":1.04946, \"pctr\":0.551225},{\"x\":0.82, \"y\":1.05714, \"pctr\":0.547141},{\"x\":0.84, \"y\":1.07176, \"pctr\":0.49577},{\"x\":0.86, \"y\":1.05475, \"pctr\":0.485212},{\"x\":0.88, \"y\":1.02229, \"pctr\":0.479892},{\"x\":0.9, \"y\":1.02968, \"pctr\":0.469313},{\"x\":0.92, \"y\":1.04382, \"pctr\":0.407275},{\"x\":0.94, \"y\":1.02869, \"pctr\":0.400387},{\"x\":0.96, \"y\":0.999713, \"pctr\":0.381605},{\"x\":0.98, \"y\":1.0068, \"pctr\":0.37832},{\"x\":1, \"y\":0.489796, \"pctr\":0.725731}]}],\"ks\":[{\"label\":1, \"x_y\":[{\"x\":0.02, \"y_tpr\":0.0204082, \"y_fpr\":0,\"prop\":0.788329, \"diff\":0.0204082},{\"x\":0.04, \"y_tpr\":0.0204082, \"y_fpr\":0.04,\"prop\":0.787467, \"diff\":-0.0195918},{\"x\":0.06, \"y_tpr\":0.0408163, \"y_fpr\":0.08,\"prop\":0.783679, \"diff\":-0.0391837},{\"x\":0.08, \"y_tpr\":0.0612245, \"y_fpr\":0.08,\"prop\":0.783307, \"diff\":-0.0187755},{\"x\":0.1, \"y_tpr\":0.0816327, \"y_fpr\":0.12,\"prop\":0.775589, \"diff\":-0.0383673},{\"x\":0.12, \"y_tpr\":0.102041, \"y_fpr\":0.12,\"prop\":0.775432, \"diff\":-0.0179592},{\"x\":0.14, \"y_tpr\":0.122449, \"y_fpr\":0.16,\"prop\":0.772949, \"diff\":-0.037551},{\"x\":0.16, \"y_tpr\":0.142857, \"y_fpr\":0.16,\"prop\":0.7714, \"diff\":-0.0171429},{\"x\":0.18, \"y_tpr\":0.163265, \"y_fpr\":0.2,\"prop\":0.77091, \"diff\":-0.0367347},{\"x\":0.2, \"y_tpr\":0.183673, \"y_fpr\":0.2,\"prop\":0.770769, \"diff\":-0.0163265},{\"x\":0.22, \"y_tpr\":0.204082, \"y_fpr\":0.24,\"prop\":0.767142, \"diff\":-0.0359184},{\"x\":0.24, \"y_tpr\":0.204082, \"y_fpr\":0.28,\"prop\":0.761485, \"diff\":-0.0759184},{\"x\":0.26, \"y_tpr\":0.244898, \"y_fpr\":0.28,\"prop\":0.758011, \"diff\":-0.035102},{\"x\":0.28, \"y_tpr\":0.244898, \"y_fpr\":0.32,\"prop\":0.757837, \"diff\":-0.075102},{\"x\":0.3, \"y_tpr\":0.285714, \"y_fpr\":0.32,\"prop\":0.7523, \"diff\":-0.0342857},{\"x\":0.32, \"y_tpr\":0.285714, \"y_fpr\":0.36,\"prop\":0.750835, \"diff\":-0.0742857},{\"x\":0.34, \"y_tpr\":0.326531, \"y_fpr\":0.36,\"prop\":0.743503, \"diff\":-0.0334694},{\"x\":0.36, \"y_tpr\":0.346939, \"y_fpr\":0.36,\"prop\":0.742114, \"diff\":-0.0130612},{\"x\":0.38, \"y_tpr\":0.387755, \"y_fpr\":0.36,\"prop\":0.738629, \"diff\":0.0277551},{\"x\":0.4, \"y_tpr\":0.408163, \"y_fpr\":0.36,\"prop\":0.734697, \"diff\":0.0481633},{\"x\":0.42, \"y_tpr\":0.428571, \"y_fpr\":0.4,\"prop\":0.733978, \"diff\":0.0285714},{\"x\":0.44, \"y_tpr\":0.44898, \"y_fpr\":0.4,\"prop\":0.733386, \"diff\":0.0489796},{\"x\":0.46, \"y_tpr\":0.469388, \"y_fpr\":0.44,\"prop\":0.727227, \"diff\":0.0293878},{\"x\":0.48, \"y_tpr\":0.489796, \"y_fpr\":0.44,\"prop\":0.725731, \"diff\":0.0497959},{\"x\":0.5, \"y_tpr\":0.510204, \"y_fpr\":0.48,\"prop\":0.722221, \"diff\":0.0302041},{\"x\":0.52, \"y_tpr\":0.530612, \"y_fpr\":0.48,\"prop\":0.721316, \"diff\":0.0506122},{\"x\":0.54, \"y_tpr\":0.530612, \"y_fpr\":0.52,\"prop\":0.716286, \"diff\":0.0106122},{\"x\":0.56, \"y_tpr\":0.55102, \"y_fpr\":0.56,\"prop\":0.70048, \"diff\":-0.00897959},{\"x\":0.58, \"y_tpr\":0.571429, \"y_fpr\":0.56,\"prop\":0.699936, \"diff\":0.0114286},{\"x\":0.6, \"y_tpr\":0.612245, \"y_fpr\":0.56,\"prop\":0.680074, \"diff\":0.0522449},{\"x\":0.62, \"y_tpr\":0.632653, \"y_fpr\":0.56,\"prop\":0.679484, \"diff\":0.0726531},{\"x\":0.64, \"y_tpr\":0.673469, \"y_fpr\":0.56,\"prop\":0.673188, \"diff\":0.113469},{\"x\":0.66, \"y_tpr\":0.693878, \"y_fpr\":0.56,\"prop\":0.662795, \"diff\":0.133878},{\"x\":0.68, \"y_tpr\":0.734694, \"y_fpr\":0.56,\"prop\":0.63814, \"diff\":0.174694},{\"x\":0.7, \"y_tpr\":0.755102, \"y_fpr\":0.56,\"prop\":0.637246, \"diff\":0.195102, \"key_value\":1},{\"x\":0.72, \"y_tpr\":0.755102, \"y_fpr\":0.64,\"prop\":0.618335, \"diff\":0.115102},{\"x\":0.74, \"y_tpr\":0.77551, \"y_fpr\":0.64,\"prop\":0.57242, \"diff\":0.13551},{\"x\":0.76, \"y_tpr\":0.816327, \"y_fpr\":0.64,\"prop\":0.570137, \"diff\":0.176327},{\"x\":0.78, \"y_tpr\":0.816327, \"y_fpr\":0.68,\"prop\":0.564805, \"diff\":0.136327},{\"x\":0.8, \"y_tpr\":0.836735, \"y_fpr\":0.72,\"prop\":0.557888, \"diff\":0.116735},{\"x\":0.82, \"y_tpr\":0.836735, \"y_fpr\":0.76,\"prop\":0.551225, \"diff\":0.0767347},{\"x\":0.84, \"y_tpr\":0.877551, \"y_fpr\":0.76,\"prop\":0.541722, \"diff\":0.117551},{\"x\":0.86, \"y_tpr\":0.897959, \"y_fpr\":0.76,\"prop\":0.49577, \"diff\":0.137959},{\"x\":0.88, \"y_tpr\":0.897959, \"y_fpr\":0.88,\"prop\":0.479892, \"diff\":0.0179592},{\"x\":0.9, \"y_tpr\":0.897959, \"y_fpr\":0.88,\"prop\":0.479892, \"diff\":0.0179592},{\"x\":0.92, \"y_tpr\":0.938776, \"y_fpr\":0.88,\"prop\":0.461631, \"diff\":0.0587755},{\"x\":0.94, \"y_tpr\":0.959184, \"y_fpr\":0.88,\"prop\":0.407275, \"diff\":0.0791837},{\"x\":0.96, \"y_tpr\":0.959184, \"y_fpr\":0.96,\"prop\":0.396323, \"diff\":-0.000816327},{\"x\":0.98, \"y_tpr\":0.959184, \"y_fpr\":1,\"prop\":0.381605, \"diff\":-0.0408163},{\"x\":1, \"y_tpr\":1, \"y_fpr\":1,\"prop\":0.37782, \"diff\":0}]}]}]}");
			DefaultCategoryDataset dataset = new DefaultCategoryDataset();
			JsonObject model = modelExplainJson.get("models").getAsJsonArray().get(0).getAsJsonObject();
			JsonArray x_y = model.get("lift_chart").getAsJsonArray().get(0)
					.getAsJsonObject().get("x_y").getAsJsonArray();
			final String series1 = "Lift chart";
			final String series2 = "Base line";
			for(int i=0;i<x_y.size();i++){
				JsonObject obj = x_y.get(i).getAsJsonObject();
				dataset.addValue(obj.get("y").getAsFloat(),series1,String.format("%.2f", obj.get("x").getAsFloat()));
				dataset.addValue(1,series2,String.format("%.1f", obj.get("x").getAsFloat()));
			}
			drawLineChart("提升图", "样本比例", "提升幅度",1024, 1024, dataset, output+"\\lift_chart.jpg");
			map.put("lift_chart",output+"\\lift_chart.jpg");
		} catch (Exception e) {
			throw new BaseException(1,"数据错误");
		}
	}
	
	
	public void drawRecallbackChart(JsonObject modelExplainJson) throws BaseException{
		logger.debug("drawRecallbackChart starting...");
		try{
		//	dataCheckResultJson	=JsonUtil.toJsonObject("{\"models\":[{\"model_name\":\"gbdt\",\"model_md5\":\"f325c228bc32111238e9b5c82de6edf2\",\"model_path\":\"/mnt/disk1/ebrain_web/ebrain_algo/188850432192286720/188850432481693696/1/gbdt/model/train_ins.model\",\"evalue_path\":\"/mnt/disk1/ebrain_web/ebrain_algo/188850432192286720/188850432481693696/1/gbdt/evaluate/train_ins.evaluate\",\"feature_importance\":[{\"feature_name\":\"Column_10_0\",\"contribution\":0.012250},{\"feature_name\":\"Column_3_1\",\"contribution\":0.021273},{\"feature_name\":\"Column_9\",\"contribution\":0.071547},{\"feature_name\":\"Column_8_0\",\"contribution\":0.073450},{\"feature_name\":\"Column_3_2\",\"contribution\":0.099013},{\"feature_name\":\"Column_4_8\",\"contribution\":0.123283},{\"feature_name\":\"Column_7_1\",\"contribution\":0.209240},{\"feature_name\":\"Column_4_3\",\"contribution\":0.255237},{\"feature_name\":\"Column_12\",\"contribution\":0.351802},{\"feature_name\":\"Column_4_6\",\"contribution\":0.900142},{\"feature_name\":\"Column_2\",\"contribution\":1.006700},{\"feature_name\":\"Column_13\",\"contribution\":1.363470},{\"feature_name\":\"Column_6\",\"contribution\":1.387640},{\"feature_name\":\"Column_4_11\",\"contribution\":1.689840},{\"feature_name\":\"Column_1\",\"contribution\":1.814310},{\"feature_name\":\"Column_5\",\"contribution\":2.768140}],\"roc\":{\"auc\":0.536327,\"x_y\":[{ \"x_value\":0,\"y_value\":0.0204082},{ \"x_value\":0.04,\"y_value\":0.0204082},{ \"x_value\":0.08,\"y_value\":0.0204082},{ \"x_value\":0.08,\"y_value\":0.0408163},{ \"x_value\":0.08,\"y_value\":0.0612245},{ \"x_value\":0.08,\"y_value\":0.0816327},{ \"x_value\":0.12,\"y_value\":0.0816327},{ \"x_value\":0.12,\"y_value\":0.102041},{ \"x_value\":0.12,\"y_value\":0.122449},{ \"x_value\":0.16,\"y_value\":0.122449},{ \"x_value\":0.16,\"y_value\":0.142857},{ \"x_value\":0.16,\"y_value\":0.163265},{ \"x_value\":0.2,\"y_value\":0.163265},{ \"x_value\":0.2,\"y_value\":0.183673},{ \"x_value\":0.2,\"y_value\":0.204082},{ \"x_value\":0.24,\"y_value\":0.204082},{ \"x_value\":0.28,\"y_value\":0.204082},{ \"x_value\":0.28,\"y_value\":0.22449},{ \"x_value\":0.28,\"y_value\":0.244898},{ \"x_value\":0.32,\"y_value\":0.244898},{ \"x_value\":0.32,\"y_value\":0.265306},{ \"x_value\":0.32,\"y_value\":0.285714},{ \"x_value\":0.36,\"y_value\":0.285714},{ \"x_value\":0.36,\"y_value\":0.306122},{ \"x_value\":0.36,\"y_value\":0.326531},{ \"x_value\":0.36,\"y_value\":0.346939},{ \"x_value\":0.36,\"y_value\":0.367347},{ \"x_value\":0.36,\"y_value\":0.387755},{ \"x_value\":0.36,\"y_value\":0.408163},{ \"x_value\":0.36,\"y_value\":0.428571},{ \"x_value\":0.4,\"y_value\":0.428571},{ \"x_value\":0.4,\"y_value\":0.44898},{ \"x_value\":0.4,\"y_value\":0.469388},{ \"x_value\":0.44,\"y_value\":0.469388},{ \"x_value\":0.44,\"y_value\":0.489796},{ \"x_value\":0.44,\"y_value\":0.510204},{ \"x_value\":0.48,\"y_value\":0.510204},{ \"x_value\":0.48,\"y_value\":0.530612},{ \"x_value\":0.52,\"y_value\":0.530612},{ \"x_value\":0.52,\"y_value\":0.55102},{ \"x_value\":0.56,\"y_value\":0.55102},{ \"x_value\":0.56,\"y_value\":0.571429},{ \"x_value\":0.56,\"y_value\":0.591837},{ \"x_value\":0.56,\"y_value\":0.612245},{ \"x_value\":0.56,\"y_value\":0.632653},{ \"x_value\":0.56,\"y_value\":0.653061},{ \"x_value\":0.56,\"y_value\":0.673469},{ \"x_value\":0.56,\"y_value\":0.693878},{ \"x_value\":0.56,\"y_value\":0.714286},{ \"x_value\":0.56,\"y_value\":0.734694},{ \"x_value\":0.56,\"y_value\":0.755102},{ \"x_value\":0.6,\"y_value\":0.755102},{ \"x_value\":0.64,\"y_value\":0.755102},{ \"x_value\":0.64,\"y_value\":0.77551},{ \"x_value\":0.64,\"y_value\":0.795918},{ \"x_value\":0.64,\"y_value\":0.816327},{ \"x_value\":0.68,\"y_value\":0.816327},{ \"x_value\":0.72,\"y_value\":0.836735},{ \"x_value\":0.76,\"y_value\":0.836735},{ \"x_value\":0.76,\"y_value\":0.857143},{ \"x_value\":0.76,\"y_value\":0.877551},{ \"x_value\":0.76,\"y_value\":0.897959},{ \"x_value\":0.8,\"y_value\":0.897959},{ \"x_value\":0.88,\"y_value\":0.897959},{ \"x_value\":0.88,\"y_value\":0.918367},{ \"x_value\":0.88,\"y_value\":0.938776},{ \"x_value\":0.88,\"y_value\":0.959184},{ \"x_value\":0.92,\"y_value\":0.959184},{ \"x_value\":0.96,\"y_value\":0.959184},{ \"x_value\":1,\"y_value\":0.959184},{ \"x_value\":1,\"y_value\":0.979592},{ \"x_value\":1,\"y_value\":1}]}, \"precise_recall\":{\"threshold\":0.400387,\"x_y\": [{\"precise\":0.657534, \"recall\":0.979592,\"pctr\":0.37782},{\"precise\":0.652778, \"recall\":0.959184,\"pctr\":0.37832},{\"precise\":0.661972, \"recall\":0.959184,\"pctr\":0.381605},{\"precise\":0.671429, \"recall\":0.959184,\"pctr\":0.396323},{\"precise\":0.681159, \"recall\":0.959184,\"pctr\":0.400387},{\"precise\":0.676471, \"recall\":0.938776,\"pctr\":0.407275},{\"precise\":0.671642, \"recall\":0.918367,\"pctr\":0.461631},{\"precise\":0.666667, \"recall\":0.897959,\"pctr\":0.469313},{\"precise\":0.6875, \"recall\":0.897959,\"pctr\":0.479892},{\"precise\":0.698413, \"recall\":0.897959,\"pctr\":0.485212},{\"precise\":0.693548, \"recall\":0.877551,\"pctr\":0.49577},{\"precise\":0.688525, \"recall\":0.857143,\"pctr\":0.541722},{\"precise\":0.683333, \"recall\":0.836735,\"pctr\":0.547141},{\"precise\":0.694915, \"recall\":0.836735,\"pctr\":0.551225},{\"precise\":0.701754, \"recall\":0.816327,\"pctr\":0.557888},{\"precise\":0.714286, \"recall\":0.816327,\"pctr\":0.564805},{\"precise\":0.709091, \"recall\":0.795918,\"pctr\":0.570137},{\"precise\":0.703704, \"recall\":0.77551,\"pctr\":0.570432},{\"precise\":0.698113, \"recall\":0.755102,\"pctr\":0.57242},{\"precise\":0.711538, \"recall\":0.755102,\"pctr\":0.618335},{\"precise\":0.72549, \"recall\":0.755102,\"pctr\":0.61837},{\"precise\":0.72, \"recall\":0.734694,\"pctr\":0.637246},{\"precise\":0.714286, \"recall\":0.714286,\"pctr\":0.63814},{\"precise\":0.708333, \"recall\":0.693878,\"pctr\":0.647823},{\"precise\":0.702128, \"recall\":0.673469,\"pctr\":0.662795},{\"precise\":0.695652, \"recall\":0.653061,\"pctr\":0.673188},{\"precise\":0.688889, \"recall\":0.632653,\"pctr\":0.675776},{\"precise\":0.681818, \"recall\":0.612245,\"pctr\":0.679484},{\"precise\":0.674419, \"recall\":0.591837,\"pctr\":0.680074},{\"precise\":0.666667, \"recall\":0.571429,\"pctr\":0.690871},{\"precise\":0.658537, \"recall\":0.55102,\"pctr\":0.699936},{\"precise\":0.675, \"recall\":0.55102,\"pctr\":0.70048},{\"precise\":0.666667, \"recall\":0.530612,\"pctr\":0.712758},{\"precise\":0.684211, \"recall\":0.530612,\"pctr\":0.716286},{\"precise\":0.675676, \"recall\":0.510204,\"pctr\":0.721316},{\"precise\":0.694444, \"recall\":0.510204,\"pctr\":0.722221},{\"precise\":0.685714, \"recall\":0.489796,\"pctr\":0.725274},{\"precise\":0.676471, \"recall\":0.469388,\"pctr\":0.725731},{\"precise\":0.69697, \"recall\":0.469388,\"pctr\":0.727227},{\"precise\":0.6875, \"recall\":0.44898,\"pctr\":0.73137},{\"precise\":0.677419, \"recall\":0.428571,\"pctr\":0.733386},{\"precise\":0.7, \"recall\":0.428571,\"pctr\":0.733978},{\"precise\":0.689655, \"recall\":0.408163,\"pctr\":0.734181},{\"precise\":0.678571, \"recall\":0.387755,\"pctr\":0.734697},{\"precise\":0.666667, \"recall\":0.367347,\"pctr\":0.738629},{\"precise\":0.653846, \"recall\":0.346939,\"pctr\":0.741727},{\"precise\":0.64, \"recall\":0.326531,\"pctr\":0.742114},{\"precise\":0.625, \"recall\":0.306122,\"pctr\":0.743503},{\"precise\":0.608696, \"recall\":0.285714,\"pctr\":0.747812},{\"precise\":0.636364, \"recall\":0.285714,\"pctr\":0.750835},{\"precise\":0.619048, \"recall\":0.265306,\"pctr\":0.7523},{\"precise\":0.6, \"recall\":0.244898,\"pctr\":0.756893},{\"precise\":0.631579, \"recall\":0.244898,\"pctr\":0.757837},{\"precise\":0.611111, \"recall\":0.22449,\"pctr\":0.758011},{\"precise\":0.588235, \"recall\":0.204082,\"pctr\":0.761057},{\"precise\":0.625, \"recall\":0.204082,\"pctr\":0.761485},{\"precise\":0.666667, \"recall\":0.204082,\"pctr\":0.767142},{\"precise\":0.642857, \"recall\":0.183673,\"pctr\":0.770279},{\"precise\":0.615385, \"recall\":0.163265,\"pctr\":0.770769},{\"precise\":0.666667, \"recall\":0.163265,\"pctr\":0.77091},{\"precise\":0.636364, \"recall\":0.142857,\"pctr\":0.771361},{\"precise\":0.6, \"recall\":0.122449,\"pctr\":0.7714},{\"precise\":0.666667, \"recall\":0.122449,\"pctr\":0.772949},{\"precise\":0.625, \"recall\":0.102041,\"pctr\":0.773744},{\"precise\":0.571429, \"recall\":0.0816327,\"pctr\":0.775432},{\"precise\":0.666667, \"recall\":0.0816327,\"pctr\":0.775589},{\"precise\":0.6, \"recall\":0.0612245,\"pctr\":0.780286},{\"precise\":0.5, \"recall\":0.0408163,\"pctr\":0.783307},{\"precise\":0.333333, \"recall\":0.0204082,\"pctr\":0.783679},{\"precise\":0.5, \"recall\":0.0204082,\"pctr\":0.784428},{\"precise\":1, \"recall\":0.0204082,\"pctr\":0.787467}] },\"confusion_matrix\":[[{\"value\":\"\"},{\"value\":\"1\"},{\"value\":\"0\"}],[{\"value\":\"1\"},{\"value\":\"47\", \"percent\":0.635135 },{\"value\":\"2\", \"percent\":0.027027}],[{\"value\":\"0\"},{\"value\":\"22\", \"percent\":0.297297 },{\"value\":\"3\", \"percent\":0.0405405}]],\"lift_chart\":[{\"label\":1, \"x_y\":[{\"x\":0.02, \"y\":1.5102, \"pctr\":0.787467},{\"x\":0.04, \"y\":0.755102, \"pctr\":0.784428},{\"x\":0.06, \"y\":1.13265, \"pctr\":0.783307},{\"x\":0.08, \"y\":1.20816, \"pctr\":0.780286},{\"x\":0.1, \"y\":1.07872, \"pctr\":0.775432},{\"x\":0.12, \"y\":1.13265, \"pctr\":0.773744},{\"x\":0.14, \"y\":1.05714, \"pctr\":0.7714},{\"x\":0.16, \"y\":1.09833, \"pctr\":0.771361},{\"x\":0.18, \"y\":1.04553, \"pctr\":0.770769},{\"x\":0.2, \"y\":1.07872, \"pctr\":0.770279},{\"x\":0.22, \"y\":0.943878, \"pctr\":0.761485},{\"x\":0.24, \"y\":0.977191, \"pctr\":0.761057},{\"x\":0.26, \"y\":0.953813, \"pctr\":0.757837},{\"x\":0.28, \"y\":0.981633, \"pctr\":0.756893},{\"x\":0.3, \"y\":0.961039, \"pctr\":0.750835},{\"x\":0.32, \"y\":0.984916, \"pctr\":0.747812},{\"x\":0.34, \"y\":1.02694, \"pctr\":0.742114},{\"x\":0.36, \"y\":1.04553, \"pctr\":0.741727},{\"x\":0.38, \"y\":1.07872, \"pctr\":0.734697},{\"x\":0.4, \"y\":1.0936, \"pctr\":0.734181},{\"x\":0.42, \"y\":1.07176, \"pctr\":0.733386},{\"x\":0.44, \"y\":1.08546, \"pctr\":0.73137},{\"x\":0.46, \"y\":1.06603, \"pctr\":0.725731},{\"x\":0.48, \"y\":1.07872, \"pctr\":0.725274},{\"x\":0.5, \"y\":1.06122, \"pctr\":0.721316},{\"x\":0.52, \"y\":1.0333, \"pctr\":0.716286},{\"x\":0.54, \"y\":1.04553, \"pctr\":0.712758},{\"x\":0.56, \"y\":1.03136, \"pctr\":0.699936},{\"x\":0.58, \"y\":1.04276, \"pctr\":0.690871},{\"x\":0.6, \"y\":1.06401, \"pctr\":0.679484},{\"x\":0.62, \"y\":1.07392, \"pctr\":0.675776},{\"x\":0.64, \"y\":1.09249, \"pctr\":0.662795},{\"x\":0.66, \"y\":1.10119, \"pctr\":0.647823},{\"x\":0.68, \"y\":1.11755, \"pctr\":0.637246},{\"x\":0.7, \"y\":1.09564, \"pctr\":0.61837},{\"x\":0.72, \"y\":1.08279, \"pctr\":0.57242},{\"x\":0.74, \"y\":1.0907, \"pctr\":0.570432},{\"x\":0.76, \"y\":1.07872, \"pctr\":0.564805},{\"x\":0.78, \"y\":1.08629, \"pctr\":0.557888},{\"x\":0.8, \"y\":1.04946, \"pctr\":0.551225},{\"x\":0.82, \"y\":1.05714, \"pctr\":0.547141},{\"x\":0.84, \"y\":1.07176, \"pctr\":0.49577},{\"x\":0.86, \"y\":1.05475, \"pctr\":0.485212},{\"x\":0.88, \"y\":1.02229, \"pctr\":0.479892},{\"x\":0.9, \"y\":1.02968, \"pctr\":0.469313},{\"x\":0.92, \"y\":1.04382, \"pctr\":0.407275},{\"x\":0.94, \"y\":1.02869, \"pctr\":0.400387},{\"x\":0.96, \"y\":0.999713, \"pctr\":0.381605},{\"x\":0.98, \"y\":1.0068, \"pctr\":0.37832},{\"x\":1, \"y\":0.489796, \"pctr\":0.725731}]}],\"ks\":[{\"label\":1, \"x_y\":[{\"x\":0.02, \"y_tpr\":0.0204082, \"y_fpr\":0,\"prop\":0.788329, \"diff\":0.0204082},{\"x\":0.04, \"y_tpr\":0.0204082, \"y_fpr\":0.04,\"prop\":0.787467, \"diff\":-0.0195918},{\"x\":0.06, \"y_tpr\":0.0408163, \"y_fpr\":0.08,\"prop\":0.783679, \"diff\":-0.0391837},{\"x\":0.08, \"y_tpr\":0.0612245, \"y_fpr\":0.08,\"prop\":0.783307, \"diff\":-0.0187755},{\"x\":0.1, \"y_tpr\":0.0816327, \"y_fpr\":0.12,\"prop\":0.775589, \"diff\":-0.0383673},{\"x\":0.12, \"y_tpr\":0.102041, \"y_fpr\":0.12,\"prop\":0.775432, \"diff\":-0.0179592},{\"x\":0.14, \"y_tpr\":0.122449, \"y_fpr\":0.16,\"prop\":0.772949, \"diff\":-0.037551},{\"x\":0.16, \"y_tpr\":0.142857, \"y_fpr\":0.16,\"prop\":0.7714, \"diff\":-0.0171429},{\"x\":0.18, \"y_tpr\":0.163265, \"y_fpr\":0.2,\"prop\":0.77091, \"diff\":-0.0367347},{\"x\":0.2, \"y_tpr\":0.183673, \"y_fpr\":0.2,\"prop\":0.770769, \"diff\":-0.0163265},{\"x\":0.22, \"y_tpr\":0.204082, \"y_fpr\":0.24,\"prop\":0.767142, \"diff\":-0.0359184},{\"x\":0.24, \"y_tpr\":0.204082, \"y_fpr\":0.28,\"prop\":0.761485, \"diff\":-0.0759184},{\"x\":0.26, \"y_tpr\":0.244898, \"y_fpr\":0.28,\"prop\":0.758011, \"diff\":-0.035102},{\"x\":0.28, \"y_tpr\":0.244898, \"y_fpr\":0.32,\"prop\":0.757837, \"diff\":-0.075102},{\"x\":0.3, \"y_tpr\":0.285714, \"y_fpr\":0.32,\"prop\":0.7523, \"diff\":-0.0342857},{\"x\":0.32, \"y_tpr\":0.285714, \"y_fpr\":0.36,\"prop\":0.750835, \"diff\":-0.0742857},{\"x\":0.34, \"y_tpr\":0.326531, \"y_fpr\":0.36,\"prop\":0.743503, \"diff\":-0.0334694},{\"x\":0.36, \"y_tpr\":0.346939, \"y_fpr\":0.36,\"prop\":0.742114, \"diff\":-0.0130612},{\"x\":0.38, \"y_tpr\":0.387755, \"y_fpr\":0.36,\"prop\":0.738629, \"diff\":0.0277551},{\"x\":0.4, \"y_tpr\":0.408163, \"y_fpr\":0.36,\"prop\":0.734697, \"diff\":0.0481633},{\"x\":0.42, \"y_tpr\":0.428571, \"y_fpr\":0.4,\"prop\":0.733978, \"diff\":0.0285714},{\"x\":0.44, \"y_tpr\":0.44898, \"y_fpr\":0.4,\"prop\":0.733386, \"diff\":0.0489796},{\"x\":0.46, \"y_tpr\":0.469388, \"y_fpr\":0.44,\"prop\":0.727227, \"diff\":0.0293878},{\"x\":0.48, \"y_tpr\":0.489796, \"y_fpr\":0.44,\"prop\":0.725731, \"diff\":0.0497959},{\"x\":0.5, \"y_tpr\":0.510204, \"y_fpr\":0.48,\"prop\":0.722221, \"diff\":0.0302041},{\"x\":0.52, \"y_tpr\":0.530612, \"y_fpr\":0.48,\"prop\":0.721316, \"diff\":0.0506122},{\"x\":0.54, \"y_tpr\":0.530612, \"y_fpr\":0.52,\"prop\":0.716286, \"diff\":0.0106122},{\"x\":0.56, \"y_tpr\":0.55102, \"y_fpr\":0.56,\"prop\":0.70048, \"diff\":-0.00897959},{\"x\":0.58, \"y_tpr\":0.571429, \"y_fpr\":0.56,\"prop\":0.699936, \"diff\":0.0114286},{\"x\":0.6, \"y_tpr\":0.612245, \"y_fpr\":0.56,\"prop\":0.680074, \"diff\":0.0522449},{\"x\":0.62, \"y_tpr\":0.632653, \"y_fpr\":0.56,\"prop\":0.679484, \"diff\":0.0726531},{\"x\":0.64, \"y_tpr\":0.673469, \"y_fpr\":0.56,\"prop\":0.673188, \"diff\":0.113469},{\"x\":0.66, \"y_tpr\":0.693878, \"y_fpr\":0.56,\"prop\":0.662795, \"diff\":0.133878},{\"x\":0.68, \"y_tpr\":0.734694, \"y_fpr\":0.56,\"prop\":0.63814, \"diff\":0.174694},{\"x\":0.7, \"y_tpr\":0.755102, \"y_fpr\":0.56,\"prop\":0.637246, \"diff\":0.195102, \"key_value\":1},{\"x\":0.72, \"y_tpr\":0.755102, \"y_fpr\":0.64,\"prop\":0.618335, \"diff\":0.115102},{\"x\":0.74, \"y_tpr\":0.77551, \"y_fpr\":0.64,\"prop\":0.57242, \"diff\":0.13551},{\"x\":0.76, \"y_tpr\":0.816327, \"y_fpr\":0.64,\"prop\":0.570137, \"diff\":0.176327},{\"x\":0.78, \"y_tpr\":0.816327, \"y_fpr\":0.68,\"prop\":0.564805, \"diff\":0.136327},{\"x\":0.8, \"y_tpr\":0.836735, \"y_fpr\":0.72,\"prop\":0.557888, \"diff\":0.116735},{\"x\":0.82, \"y_tpr\":0.836735, \"y_fpr\":0.76,\"prop\":0.551225, \"diff\":0.0767347},{\"x\":0.84, \"y_tpr\":0.877551, \"y_fpr\":0.76,\"prop\":0.541722, \"diff\":0.117551},{\"x\":0.86, \"y_tpr\":0.897959, \"y_fpr\":0.76,\"prop\":0.49577, \"diff\":0.137959},{\"x\":0.88, \"y_tpr\":0.897959, \"y_fpr\":0.88,\"prop\":0.479892, \"diff\":0.0179592},{\"x\":0.9, \"y_tpr\":0.897959, \"y_fpr\":0.88,\"prop\":0.479892, \"diff\":0.0179592},{\"x\":0.92, \"y_tpr\":0.938776, \"y_fpr\":0.88,\"prop\":0.461631, \"diff\":0.0587755},{\"x\":0.94, \"y_tpr\":0.959184, \"y_fpr\":0.88,\"prop\":0.407275, \"diff\":0.0791837},{\"x\":0.96, \"y_tpr\":0.959184, \"y_fpr\":0.96,\"prop\":0.396323, \"diff\":-0.000816327},{\"x\":0.98, \"y_tpr\":0.959184, \"y_fpr\":1,\"prop\":0.381605, \"diff\":-0.0408163},{\"x\":1, \"y_tpr\":1, \"y_fpr\":1,\"prop\":0.37782, \"diff\":0}]}]}]}");
			DefaultCategoryDataset dataset = new DefaultCategoryDataset();
			JsonObject model = modelExplainJson.get("models").getAsJsonArray().get(0).getAsJsonObject();
			JsonArray x_y = model.get("precise_recall").getAsJsonObject().get("x_y").getAsJsonArray();
			final String series1 = "precise";
			final String series2 = "recall";
			for(int i=0;i<x_y.size();i++){
				JsonObject obj = x_y.get(i).getAsJsonObject();
				dataset.addValue(obj.get("precise").getAsFloat(),series1,String.format("%.2f", obj.get("pctr").getAsFloat()));
				dataset.addValue(obj.get("recall").getAsFloat(),series2,String.format("%.2f", obj.get("pctr").getAsFloat()));
			}
			drawLineChart("准确&召回", "分类阈值", "准确率&召回率",1024, 1024, dataset, output+"\\recall_chart.jpg");
			map.put("recall_chart",output+"\\recall_chart.jpg");
		} catch (Exception e) {
			throw new BaseException(1,"数据错误");
		}
	}
	
	public void drawKSChart(JsonObject modelExplainJson) throws BaseException{
		logger.debug("drawKSChart starting...");
		try{
			//dataCheckResultJson	=JsonUtil.toJsonObject("{\"models\":[{\"model_name\":\"gbdt\",\"model_md5\":\"f325c228bc32111238e9b5c82de6edf2\",\"model_path\":\"/mnt/disk1/ebrain_web/ebrain_algo/188850432192286720/188850432481693696/1/gbdt/model/train_ins.model\",\"evalue_path\":\"/mnt/disk1/ebrain_web/ebrain_algo/188850432192286720/188850432481693696/1/gbdt/evaluate/train_ins.evaluate\",\"feature_importance\":[{\"feature_name\":\"Column_10_0\",\"contribution\":0.012250},{\"feature_name\":\"Column_3_1\",\"contribution\":0.021273},{\"feature_name\":\"Column_9\",\"contribution\":0.071547},{\"feature_name\":\"Column_8_0\",\"contribution\":0.073450},{\"feature_name\":\"Column_3_2\",\"contribution\":0.099013},{\"feature_name\":\"Column_4_8\",\"contribution\":0.123283},{\"feature_name\":\"Column_7_1\",\"contribution\":0.209240},{\"feature_name\":\"Column_4_3\",\"contribution\":0.255237},{\"feature_name\":\"Column_12\",\"contribution\":0.351802},{\"feature_name\":\"Column_4_6\",\"contribution\":0.900142},{\"feature_name\":\"Column_2\",\"contribution\":1.006700},{\"feature_name\":\"Column_13\",\"contribution\":1.363470},{\"feature_name\":\"Column_6\",\"contribution\":1.387640},{\"feature_name\":\"Column_4_11\",\"contribution\":1.689840},{\"feature_name\":\"Column_1\",\"contribution\":1.814310},{\"feature_name\":\"Column_5\",\"contribution\":2.768140}],\"roc\":{\"auc\":0.536327,\"x_y\":[{ \"x_value\":0,\"y_value\":0.0204082},{ \"x_value\":0.04,\"y_value\":0.0204082},{ \"x_value\":0.08,\"y_value\":0.0204082},{ \"x_value\":0.08,\"y_value\":0.0408163},{ \"x_value\":0.08,\"y_value\":0.0612245},{ \"x_value\":0.08,\"y_value\":0.0816327},{ \"x_value\":0.12,\"y_value\":0.0816327},{ \"x_value\":0.12,\"y_value\":0.102041},{ \"x_value\":0.12,\"y_value\":0.122449},{ \"x_value\":0.16,\"y_value\":0.122449},{ \"x_value\":0.16,\"y_value\":0.142857},{ \"x_value\":0.16,\"y_value\":0.163265},{ \"x_value\":0.2,\"y_value\":0.163265},{ \"x_value\":0.2,\"y_value\":0.183673},{ \"x_value\":0.2,\"y_value\":0.204082},{ \"x_value\":0.24,\"y_value\":0.204082},{ \"x_value\":0.28,\"y_value\":0.204082},{ \"x_value\":0.28,\"y_value\":0.22449},{ \"x_value\":0.28,\"y_value\":0.244898},{ \"x_value\":0.32,\"y_value\":0.244898},{ \"x_value\":0.32,\"y_value\":0.265306},{ \"x_value\":0.32,\"y_value\":0.285714},{ \"x_value\":0.36,\"y_value\":0.285714},{ \"x_value\":0.36,\"y_value\":0.306122},{ \"x_value\":0.36,\"y_value\":0.326531},{ \"x_value\":0.36,\"y_value\":0.346939},{ \"x_value\":0.36,\"y_value\":0.367347},{ \"x_value\":0.36,\"y_value\":0.387755},{ \"x_value\":0.36,\"y_value\":0.408163},{ \"x_value\":0.36,\"y_value\":0.428571},{ \"x_value\":0.4,\"y_value\":0.428571},{ \"x_value\":0.4,\"y_value\":0.44898},{ \"x_value\":0.4,\"y_value\":0.469388},{ \"x_value\":0.44,\"y_value\":0.469388},{ \"x_value\":0.44,\"y_value\":0.489796},{ \"x_value\":0.44,\"y_value\":0.510204},{ \"x_value\":0.48,\"y_value\":0.510204},{ \"x_value\":0.48,\"y_value\":0.530612},{ \"x_value\":0.52,\"y_value\":0.530612},{ \"x_value\":0.52,\"y_value\":0.55102},{ \"x_value\":0.56,\"y_value\":0.55102},{ \"x_value\":0.56,\"y_value\":0.571429},{ \"x_value\":0.56,\"y_value\":0.591837},{ \"x_value\":0.56,\"y_value\":0.612245},{ \"x_value\":0.56,\"y_value\":0.632653},{ \"x_value\":0.56,\"y_value\":0.653061},{ \"x_value\":0.56,\"y_value\":0.673469},{ \"x_value\":0.56,\"y_value\":0.693878},{ \"x_value\":0.56,\"y_value\":0.714286},{ \"x_value\":0.56,\"y_value\":0.734694},{ \"x_value\":0.56,\"y_value\":0.755102},{ \"x_value\":0.6,\"y_value\":0.755102},{ \"x_value\":0.64,\"y_value\":0.755102},{ \"x_value\":0.64,\"y_value\":0.77551},{ \"x_value\":0.64,\"y_value\":0.795918},{ \"x_value\":0.64,\"y_value\":0.816327},{ \"x_value\":0.68,\"y_value\":0.816327},{ \"x_value\":0.72,\"y_value\":0.836735},{ \"x_value\":0.76,\"y_value\":0.836735},{ \"x_value\":0.76,\"y_value\":0.857143},{ \"x_value\":0.76,\"y_value\":0.877551},{ \"x_value\":0.76,\"y_value\":0.897959},{ \"x_value\":0.8,\"y_value\":0.897959},{ \"x_value\":0.88,\"y_value\":0.897959},{ \"x_value\":0.88,\"y_value\":0.918367},{ \"x_value\":0.88,\"y_value\":0.938776},{ \"x_value\":0.88,\"y_value\":0.959184},{ \"x_value\":0.92,\"y_value\":0.959184},{ \"x_value\":0.96,\"y_value\":0.959184},{ \"x_value\":1,\"y_value\":0.959184},{ \"x_value\":1,\"y_value\":0.979592},{ \"x_value\":1,\"y_value\":1}]}, \"precise_recall\":{\"threshold\":0.400387,\"x_y\": [{\"precise\":0.657534, \"recall\":0.979592,\"pctr\":0.37782},{\"precise\":0.652778, \"recall\":0.959184,\"pctr\":0.37832},{\"precise\":0.661972, \"recall\":0.959184,\"pctr\":0.381605},{\"precise\":0.671429, \"recall\":0.959184,\"pctr\":0.396323},{\"precise\":0.681159, \"recall\":0.959184,\"pctr\":0.400387},{\"precise\":0.676471, \"recall\":0.938776,\"pctr\":0.407275},{\"precise\":0.671642, \"recall\":0.918367,\"pctr\":0.461631},{\"precise\":0.666667, \"recall\":0.897959,\"pctr\":0.469313},{\"precise\":0.6875, \"recall\":0.897959,\"pctr\":0.479892},{\"precise\":0.698413, \"recall\":0.897959,\"pctr\":0.485212},{\"precise\":0.693548, \"recall\":0.877551,\"pctr\":0.49577},{\"precise\":0.688525, \"recall\":0.857143,\"pctr\":0.541722},{\"precise\":0.683333, \"recall\":0.836735,\"pctr\":0.547141},{\"precise\":0.694915, \"recall\":0.836735,\"pctr\":0.551225},{\"precise\":0.701754, \"recall\":0.816327,\"pctr\":0.557888},{\"precise\":0.714286, \"recall\":0.816327,\"pctr\":0.564805},{\"precise\":0.709091, \"recall\":0.795918,\"pctr\":0.570137},{\"precise\":0.703704, \"recall\":0.77551,\"pctr\":0.570432},{\"precise\":0.698113, \"recall\":0.755102,\"pctr\":0.57242},{\"precise\":0.711538, \"recall\":0.755102,\"pctr\":0.618335},{\"precise\":0.72549, \"recall\":0.755102,\"pctr\":0.61837},{\"precise\":0.72, \"recall\":0.734694,\"pctr\":0.637246},{\"precise\":0.714286, \"recall\":0.714286,\"pctr\":0.63814},{\"precise\":0.708333, \"recall\":0.693878,\"pctr\":0.647823},{\"precise\":0.702128, \"recall\":0.673469,\"pctr\":0.662795},{\"precise\":0.695652, \"recall\":0.653061,\"pctr\":0.673188},{\"precise\":0.688889, \"recall\":0.632653,\"pctr\":0.675776},{\"precise\":0.681818, \"recall\":0.612245,\"pctr\":0.679484},{\"precise\":0.674419, \"recall\":0.591837,\"pctr\":0.680074},{\"precise\":0.666667, \"recall\":0.571429,\"pctr\":0.690871},{\"precise\":0.658537, \"recall\":0.55102,\"pctr\":0.699936},{\"precise\":0.675, \"recall\":0.55102,\"pctr\":0.70048},{\"precise\":0.666667, \"recall\":0.530612,\"pctr\":0.712758},{\"precise\":0.684211, \"recall\":0.530612,\"pctr\":0.716286},{\"precise\":0.675676, \"recall\":0.510204,\"pctr\":0.721316},{\"precise\":0.694444, \"recall\":0.510204,\"pctr\":0.722221},{\"precise\":0.685714, \"recall\":0.489796,\"pctr\":0.725274},{\"precise\":0.676471, \"recall\":0.469388,\"pctr\":0.725731},{\"precise\":0.69697, \"recall\":0.469388,\"pctr\":0.727227},{\"precise\":0.6875, \"recall\":0.44898,\"pctr\":0.73137},{\"precise\":0.677419, \"recall\":0.428571,\"pctr\":0.733386},{\"precise\":0.7, \"recall\":0.428571,\"pctr\":0.733978},{\"precise\":0.689655, \"recall\":0.408163,\"pctr\":0.734181},{\"precise\":0.678571, \"recall\":0.387755,\"pctr\":0.734697},{\"precise\":0.666667, \"recall\":0.367347,\"pctr\":0.738629},{\"precise\":0.653846, \"recall\":0.346939,\"pctr\":0.741727},{\"precise\":0.64, \"recall\":0.326531,\"pctr\":0.742114},{\"precise\":0.625, \"recall\":0.306122,\"pctr\":0.743503},{\"precise\":0.608696, \"recall\":0.285714,\"pctr\":0.747812},{\"precise\":0.636364, \"recall\":0.285714,\"pctr\":0.750835},{\"precise\":0.619048, \"recall\":0.265306,\"pctr\":0.7523},{\"precise\":0.6, \"recall\":0.244898,\"pctr\":0.756893},{\"precise\":0.631579, \"recall\":0.244898,\"pctr\":0.757837},{\"precise\":0.611111, \"recall\":0.22449,\"pctr\":0.758011},{\"precise\":0.588235, \"recall\":0.204082,\"pctr\":0.761057},{\"precise\":0.625, \"recall\":0.204082,\"pctr\":0.761485},{\"precise\":0.666667, \"recall\":0.204082,\"pctr\":0.767142},{\"precise\":0.642857, \"recall\":0.183673,\"pctr\":0.770279},{\"precise\":0.615385, \"recall\":0.163265,\"pctr\":0.770769},{\"precise\":0.666667, \"recall\":0.163265,\"pctr\":0.77091},{\"precise\":0.636364, \"recall\":0.142857,\"pctr\":0.771361},{\"precise\":0.6, \"recall\":0.122449,\"pctr\":0.7714},{\"precise\":0.666667, \"recall\":0.122449,\"pctr\":0.772949},{\"precise\":0.625, \"recall\":0.102041,\"pctr\":0.773744},{\"precise\":0.571429, \"recall\":0.0816327,\"pctr\":0.775432},{\"precise\":0.666667, \"recall\":0.0816327,\"pctr\":0.775589},{\"precise\":0.6, \"recall\":0.0612245,\"pctr\":0.780286},{\"precise\":0.5, \"recall\":0.0408163,\"pctr\":0.783307},{\"precise\":0.333333, \"recall\":0.0204082,\"pctr\":0.783679},{\"precise\":0.5, \"recall\":0.0204082,\"pctr\":0.784428},{\"precise\":1, \"recall\":0.0204082,\"pctr\":0.787467}] },\"confusion_matrix\":[[{\"value\":\"\"},{\"value\":\"1\"},{\"value\":\"0\"}],[{\"value\":\"1\"},{\"value\":\"47\", \"percent\":0.635135 },{\"value\":\"2\", \"percent\":0.027027}],[{\"value\":\"0\"},{\"value\":\"22\", \"percent\":0.297297 },{\"value\":\"3\", \"percent\":0.0405405}]],\"lift_chart\":[{\"label\":1, \"x_y\":[{\"x\":0.02, \"y\":1.5102, \"pctr\":0.787467},{\"x\":0.04, \"y\":0.755102, \"pctr\":0.784428},{\"x\":0.06, \"y\":1.13265, \"pctr\":0.783307},{\"x\":0.08, \"y\":1.20816, \"pctr\":0.780286},{\"x\":0.1, \"y\":1.07872, \"pctr\":0.775432},{\"x\":0.12, \"y\":1.13265, \"pctr\":0.773744},{\"x\":0.14, \"y\":1.05714, \"pctr\":0.7714},{\"x\":0.16, \"y\":1.09833, \"pctr\":0.771361},{\"x\":0.18, \"y\":1.04553, \"pctr\":0.770769},{\"x\":0.2, \"y\":1.07872, \"pctr\":0.770279},{\"x\":0.22, \"y\":0.943878, \"pctr\":0.761485},{\"x\":0.24, \"y\":0.977191, \"pctr\":0.761057},{\"x\":0.26, \"y\":0.953813, \"pctr\":0.757837},{\"x\":0.28, \"y\":0.981633, \"pctr\":0.756893},{\"x\":0.3, \"y\":0.961039, \"pctr\":0.750835},{\"x\":0.32, \"y\":0.984916, \"pctr\":0.747812},{\"x\":0.34, \"y\":1.02694, \"pctr\":0.742114},{\"x\":0.36, \"y\":1.04553, \"pctr\":0.741727},{\"x\":0.38, \"y\":1.07872, \"pctr\":0.734697},{\"x\":0.4, \"y\":1.0936, \"pctr\":0.734181},{\"x\":0.42, \"y\":1.07176, \"pctr\":0.733386},{\"x\":0.44, \"y\":1.08546, \"pctr\":0.73137},{\"x\":0.46, \"y\":1.06603, \"pctr\":0.725731},{\"x\":0.48, \"y\":1.07872, \"pctr\":0.725274},{\"x\":0.5, \"y\":1.06122, \"pctr\":0.721316},{\"x\":0.52, \"y\":1.0333, \"pctr\":0.716286},{\"x\":0.54, \"y\":1.04553, \"pctr\":0.712758},{\"x\":0.56, \"y\":1.03136, \"pctr\":0.699936},{\"x\":0.58, \"y\":1.04276, \"pctr\":0.690871},{\"x\":0.6, \"y\":1.06401, \"pctr\":0.679484},{\"x\":0.62, \"y\":1.07392, \"pctr\":0.675776},{\"x\":0.64, \"y\":1.09249, \"pctr\":0.662795},{\"x\":0.66, \"y\":1.10119, \"pctr\":0.647823},{\"x\":0.68, \"y\":1.11755, \"pctr\":0.637246},{\"x\":0.7, \"y\":1.09564, \"pctr\":0.61837},{\"x\":0.72, \"y\":1.08279, \"pctr\":0.57242},{\"x\":0.74, \"y\":1.0907, \"pctr\":0.570432},{\"x\":0.76, \"y\":1.07872, \"pctr\":0.564805},{\"x\":0.78, \"y\":1.08629, \"pctr\":0.557888},{\"x\":0.8, \"y\":1.04946, \"pctr\":0.551225},{\"x\":0.82, \"y\":1.05714, \"pctr\":0.547141},{\"x\":0.84, \"y\":1.07176, \"pctr\":0.49577},{\"x\":0.86, \"y\":1.05475, \"pctr\":0.485212},{\"x\":0.88, \"y\":1.02229, \"pctr\":0.479892},{\"x\":0.9, \"y\":1.02968, \"pctr\":0.469313},{\"x\":0.92, \"y\":1.04382, \"pctr\":0.407275},{\"x\":0.94, \"y\":1.02869, \"pctr\":0.400387},{\"x\":0.96, \"y\":0.999713, \"pctr\":0.381605},{\"x\":0.98, \"y\":1.0068, \"pctr\":0.37832},{\"x\":1, \"y\":0.489796, \"pctr\":0.725731}]}],\"ks\":[{\"label\":1, \"x_y\":[{\"x\":0.02, \"y_tpr\":0.0204082, \"y_fpr\":0,\"prop\":0.788329, \"diff\":0.0204082},{\"x\":0.04, \"y_tpr\":0.0204082, \"y_fpr\":0.04,\"prop\":0.787467, \"diff\":-0.0195918},{\"x\":0.06, \"y_tpr\":0.0408163, \"y_fpr\":0.08,\"prop\":0.783679, \"diff\":-0.0391837},{\"x\":0.08, \"y_tpr\":0.0612245, \"y_fpr\":0.08,\"prop\":0.783307, \"diff\":-0.0187755},{\"x\":0.1, \"y_tpr\":0.0816327, \"y_fpr\":0.12,\"prop\":0.775589, \"diff\":-0.0383673},{\"x\":0.12, \"y_tpr\":0.102041, \"y_fpr\":0.12,\"prop\":0.775432, \"diff\":-0.0179592},{\"x\":0.14, \"y_tpr\":0.122449, \"y_fpr\":0.16,\"prop\":0.772949, \"diff\":-0.037551},{\"x\":0.16, \"y_tpr\":0.142857, \"y_fpr\":0.16,\"prop\":0.7714, \"diff\":-0.0171429},{\"x\":0.18, \"y_tpr\":0.163265, \"y_fpr\":0.2,\"prop\":0.77091, \"diff\":-0.0367347},{\"x\":0.2, \"y_tpr\":0.183673, \"y_fpr\":0.2,\"prop\":0.770769, \"diff\":-0.0163265},{\"x\":0.22, \"y_tpr\":0.204082, \"y_fpr\":0.24,\"prop\":0.767142, \"diff\":-0.0359184},{\"x\":0.24, \"y_tpr\":0.204082, \"y_fpr\":0.28,\"prop\":0.761485, \"diff\":-0.0759184},{\"x\":0.26, \"y_tpr\":0.244898, \"y_fpr\":0.28,\"prop\":0.758011, \"diff\":-0.035102},{\"x\":0.28, \"y_tpr\":0.244898, \"y_fpr\":0.32,\"prop\":0.757837, \"diff\":-0.075102},{\"x\":0.3, \"y_tpr\":0.285714, \"y_fpr\":0.32,\"prop\":0.7523, \"diff\":-0.0342857},{\"x\":0.32, \"y_tpr\":0.285714, \"y_fpr\":0.36,\"prop\":0.750835, \"diff\":-0.0742857},{\"x\":0.34, \"y_tpr\":0.326531, \"y_fpr\":0.36,\"prop\":0.743503, \"diff\":-0.0334694},{\"x\":0.36, \"y_tpr\":0.346939, \"y_fpr\":0.36,\"prop\":0.742114, \"diff\":-0.0130612},{\"x\":0.38, \"y_tpr\":0.387755, \"y_fpr\":0.36,\"prop\":0.738629, \"diff\":0.0277551},{\"x\":0.4, \"y_tpr\":0.408163, \"y_fpr\":0.36,\"prop\":0.734697, \"diff\":0.0481633},{\"x\":0.42, \"y_tpr\":0.428571, \"y_fpr\":0.4,\"prop\":0.733978, \"diff\":0.0285714},{\"x\":0.44, \"y_tpr\":0.44898, \"y_fpr\":0.4,\"prop\":0.733386, \"diff\":0.0489796},{\"x\":0.46, \"y_tpr\":0.469388, \"y_fpr\":0.44,\"prop\":0.727227, \"diff\":0.0293878},{\"x\":0.48, \"y_tpr\":0.489796, \"y_fpr\":0.44,\"prop\":0.725731, \"diff\":0.0497959},{\"x\":0.5, \"y_tpr\":0.510204, \"y_fpr\":0.48,\"prop\":0.722221, \"diff\":0.0302041},{\"x\":0.52, \"y_tpr\":0.530612, \"y_fpr\":0.48,\"prop\":0.721316, \"diff\":0.0506122},{\"x\":0.54, \"y_tpr\":0.530612, \"y_fpr\":0.52,\"prop\":0.716286, \"diff\":0.0106122},{\"x\":0.56, \"y_tpr\":0.55102, \"y_fpr\":0.56,\"prop\":0.70048, \"diff\":-0.00897959},{\"x\":0.58, \"y_tpr\":0.571429, \"y_fpr\":0.56,\"prop\":0.699936, \"diff\":0.0114286},{\"x\":0.6, \"y_tpr\":0.612245, \"y_fpr\":0.56,\"prop\":0.680074, \"diff\":0.0522449},{\"x\":0.62, \"y_tpr\":0.632653, \"y_fpr\":0.56,\"prop\":0.679484, \"diff\":0.0726531},{\"x\":0.64, \"y_tpr\":0.673469, \"y_fpr\":0.56,\"prop\":0.673188, \"diff\":0.113469},{\"x\":0.66, \"y_tpr\":0.693878, \"y_fpr\":0.56,\"prop\":0.662795, \"diff\":0.133878},{\"x\":0.68, \"y_tpr\":0.734694, \"y_fpr\":0.56,\"prop\":0.63814, \"diff\":0.174694},{\"x\":0.7, \"y_tpr\":0.755102, \"y_fpr\":0.56,\"prop\":0.637246, \"diff\":0.195102, \"key_value\":1},{\"x\":0.72, \"y_tpr\":0.755102, \"y_fpr\":0.64,\"prop\":0.618335, \"diff\":0.115102},{\"x\":0.74, \"y_tpr\":0.77551, \"y_fpr\":0.64,\"prop\":0.57242, \"diff\":0.13551},{\"x\":0.76, \"y_tpr\":0.816327, \"y_fpr\":0.64,\"prop\":0.570137, \"diff\":0.176327},{\"x\":0.78, \"y_tpr\":0.816327, \"y_fpr\":0.68,\"prop\":0.564805, \"diff\":0.136327},{\"x\":0.8, \"y_tpr\":0.836735, \"y_fpr\":0.72,\"prop\":0.557888, \"diff\":0.116735},{\"x\":0.82, \"y_tpr\":0.836735, \"y_fpr\":0.76,\"prop\":0.551225, \"diff\":0.0767347},{\"x\":0.84, \"y_tpr\":0.877551, \"y_fpr\":0.76,\"prop\":0.541722, \"diff\":0.117551},{\"x\":0.86, \"y_tpr\":0.897959, \"y_fpr\":0.76,\"prop\":0.49577, \"diff\":0.137959},{\"x\":0.88, \"y_tpr\":0.897959, \"y_fpr\":0.88,\"prop\":0.479892, \"diff\":0.0179592},{\"x\":0.9, \"y_tpr\":0.897959, \"y_fpr\":0.88,\"prop\":0.479892, \"diff\":0.0179592},{\"x\":0.92, \"y_tpr\":0.938776, \"y_fpr\":0.88,\"prop\":0.461631, \"diff\":0.0587755},{\"x\":0.94, \"y_tpr\":0.959184, \"y_fpr\":0.88,\"prop\":0.407275, \"diff\":0.0791837},{\"x\":0.96, \"y_tpr\":0.959184, \"y_fpr\":0.96,\"prop\":0.396323, \"diff\":-0.000816327},{\"x\":0.98, \"y_tpr\":0.959184, \"y_fpr\":1,\"prop\":0.381605, \"diff\":-0.0408163},{\"x\":1, \"y_tpr\":1, \"y_fpr\":1,\"prop\":0.37782, \"diff\":0}]}]}]}");
			DefaultCategoryDataset dataset = new DefaultCategoryDataset();
			JsonObject model = modelExplainJson.get("models").getAsJsonArray().get(0).getAsJsonObject();
			JsonArray x_y = model.get("ks").getAsJsonArray().get(0)
					.getAsJsonObject().get("x_y").getAsJsonArray();
			final String series1 = "K";
			final String series2 = "S";
			for(int i=0;i<x_y.size();i++){
				JsonObject obj = x_y.get(i).getAsJsonObject();
				dataset.addValue(obj.get("y_tpr").getAsFloat(),series1,String.format("%.2f", obj.get("x").getAsFloat()));
				dataset.addValue(obj.get("y_fpr").getAsFloat(),series2,String.format("%.2f", obj.get("x").getAsFloat()));
			}
			drawLineChart("KSChart", "样本占比", "正确率",1024, 1024, dataset, output+"\\ks_chart.jpg");
			map.put("ks_chart",output+"\\ks_chart.jpg");
		} catch (Exception e) {
			throw new BaseException(1,"数据错误");
		}
	}
	
	public void drawRocChart(JsonObject modelExplainJson) throws BaseException{
		logger.debug("drawRocChart starting...");
		try{
		//	dataCheckResultJson	=JsonUtil.toJsonObject("{\"models\":[{\"model_name\":\"gbdt\",\"model_md5\":\"f325c228bc32111238e9b5c82de6edf2\",\"model_path\":\"/mnt/disk1/ebrain_web/ebrain_algo/188850432192286720/188850432481693696/1/gbdt/model/train_ins.model\",\"evalue_path\":\"/mnt/disk1/ebrain_web/ebrain_algo/188850432192286720/188850432481693696/1/gbdt/evaluate/train_ins.evaluate\",\"feature_importance\":[{\"feature_name\":\"Column_10_0\",\"contribution\":0.012250},{\"feature_name\":\"Column_3_1\",\"contribution\":0.021273},{\"feature_name\":\"Column_9\",\"contribution\":0.071547},{\"feature_name\":\"Column_8_0\",\"contribution\":0.073450},{\"feature_name\":\"Column_3_2\",\"contribution\":0.099013},{\"feature_name\":\"Column_4_8\",\"contribution\":0.123283},{\"feature_name\":\"Column_7_1\",\"contribution\":0.209240},{\"feature_name\":\"Column_4_3\",\"contribution\":0.255237},{\"feature_name\":\"Column_12\",\"contribution\":0.351802},{\"feature_name\":\"Column_4_6\",\"contribution\":0.900142},{\"feature_name\":\"Column_2\",\"contribution\":1.006700},{\"feature_name\":\"Column_13\",\"contribution\":1.363470},{\"feature_name\":\"Column_6\",\"contribution\":1.387640},{\"feature_name\":\"Column_4_11\",\"contribution\":1.689840},{\"feature_name\":\"Column_1\",\"contribution\":1.814310},{\"feature_name\":\"Column_5\",\"contribution\":2.768140}],\"roc\":{\"auc\":0.536327,\"x_y\":[{ \"x_value\":0,\"y_value\":0.0204082},{ \"x_value\":0.04,\"y_value\":0.0204082},{ \"x_value\":0.08,\"y_value\":0.0204082},{ \"x_value\":0.08,\"y_value\":0.0408163},{ \"x_value\":0.08,\"y_value\":0.0612245},{ \"x_value\":0.08,\"y_value\":0.0816327},{ \"x_value\":0.12,\"y_value\":0.0816327},{ \"x_value\":0.12,\"y_value\":0.102041},{ \"x_value\":0.12,\"y_value\":0.122449},{ \"x_value\":0.16,\"y_value\":0.122449},{ \"x_value\":0.16,\"y_value\":0.142857},{ \"x_value\":0.16,\"y_value\":0.163265},{ \"x_value\":0.2,\"y_value\":0.163265},{ \"x_value\":0.2,\"y_value\":0.183673},{ \"x_value\":0.2,\"y_value\":0.204082},{ \"x_value\":0.24,\"y_value\":0.204082},{ \"x_value\":0.28,\"y_value\":0.204082},{ \"x_value\":0.28,\"y_value\":0.22449},{ \"x_value\":0.28,\"y_value\":0.244898},{ \"x_value\":0.32,\"y_value\":0.244898},{ \"x_value\":0.32,\"y_value\":0.265306},{ \"x_value\":0.32,\"y_value\":0.285714},{ \"x_value\":0.36,\"y_value\":0.285714},{ \"x_value\":0.36,\"y_value\":0.306122},{ \"x_value\":0.36,\"y_value\":0.326531},{ \"x_value\":0.36,\"y_value\":0.346939},{ \"x_value\":0.36,\"y_value\":0.367347},{ \"x_value\":0.36,\"y_value\":0.387755},{ \"x_value\":0.36,\"y_value\":0.408163},{ \"x_value\":0.36,\"y_value\":0.428571},{ \"x_value\":0.4,\"y_value\":0.428571},{ \"x_value\":0.4,\"y_value\":0.44898},{ \"x_value\":0.4,\"y_value\":0.469388},{ \"x_value\":0.44,\"y_value\":0.469388},{ \"x_value\":0.44,\"y_value\":0.489796},{ \"x_value\":0.44,\"y_value\":0.510204},{ \"x_value\":0.48,\"y_value\":0.510204},{ \"x_value\":0.48,\"y_value\":0.530612},{ \"x_value\":0.52,\"y_value\":0.530612},{ \"x_value\":0.52,\"y_value\":0.55102},{ \"x_value\":0.56,\"y_value\":0.55102},{ \"x_value\":0.56,\"y_value\":0.571429},{ \"x_value\":0.56,\"y_value\":0.591837},{ \"x_value\":0.56,\"y_value\":0.612245},{ \"x_value\":0.56,\"y_value\":0.632653},{ \"x_value\":0.56,\"y_value\":0.653061},{ \"x_value\":0.56,\"y_value\":0.673469},{ \"x_value\":0.56,\"y_value\":0.693878},{ \"x_value\":0.56,\"y_value\":0.714286},{ \"x_value\":0.56,\"y_value\":0.734694},{ \"x_value\":0.56,\"y_value\":0.755102},{ \"x_value\":0.6,\"y_value\":0.755102},{ \"x_value\":0.64,\"y_value\":0.755102},{ \"x_value\":0.64,\"y_value\":0.77551},{ \"x_value\":0.64,\"y_value\":0.795918},{ \"x_value\":0.64,\"y_value\":0.816327},{ \"x_value\":0.68,\"y_value\":0.816327},{ \"x_value\":0.72,\"y_value\":0.836735},{ \"x_value\":0.76,\"y_value\":0.836735},{ \"x_value\":0.76,\"y_value\":0.857143},{ \"x_value\":0.76,\"y_value\":0.877551},{ \"x_value\":0.76,\"y_value\":0.897959},{ \"x_value\":0.8,\"y_value\":0.897959},{ \"x_value\":0.88,\"y_value\":0.897959},{ \"x_value\":0.88,\"y_value\":0.918367},{ \"x_value\":0.88,\"y_value\":0.938776},{ \"x_value\":0.88,\"y_value\":0.959184},{ \"x_value\":0.92,\"y_value\":0.959184},{ \"x_value\":0.96,\"y_value\":0.959184},{ \"x_value\":1,\"y_value\":0.959184},{ \"x_value\":1,\"y_value\":0.979592},{ \"x_value\":1,\"y_value\":1}]}, \"precise_recall\":{\"threshold\":0.400387,\"x_y\": [{\"precise\":0.657534, \"recall\":0.979592,\"pctr\":0.37782},{\"precise\":0.652778, \"recall\":0.959184,\"pctr\":0.37832},{\"precise\":0.661972, \"recall\":0.959184,\"pctr\":0.381605},{\"precise\":0.671429, \"recall\":0.959184,\"pctr\":0.396323},{\"precise\":0.681159, \"recall\":0.959184,\"pctr\":0.400387},{\"precise\":0.676471, \"recall\":0.938776,\"pctr\":0.407275},{\"precise\":0.671642, \"recall\":0.918367,\"pctr\":0.461631},{\"precise\":0.666667, \"recall\":0.897959,\"pctr\":0.469313},{\"precise\":0.6875, \"recall\":0.897959,\"pctr\":0.479892},{\"precise\":0.698413, \"recall\":0.897959,\"pctr\":0.485212},{\"precise\":0.693548, \"recall\":0.877551,\"pctr\":0.49577},{\"precise\":0.688525, \"recall\":0.857143,\"pctr\":0.541722},{\"precise\":0.683333, \"recall\":0.836735,\"pctr\":0.547141},{\"precise\":0.694915, \"recall\":0.836735,\"pctr\":0.551225},{\"precise\":0.701754, \"recall\":0.816327,\"pctr\":0.557888},{\"precise\":0.714286, \"recall\":0.816327,\"pctr\":0.564805},{\"precise\":0.709091, \"recall\":0.795918,\"pctr\":0.570137},{\"precise\":0.703704, \"recall\":0.77551,\"pctr\":0.570432},{\"precise\":0.698113, \"recall\":0.755102,\"pctr\":0.57242},{\"precise\":0.711538, \"recall\":0.755102,\"pctr\":0.618335},{\"precise\":0.72549, \"recall\":0.755102,\"pctr\":0.61837},{\"precise\":0.72, \"recall\":0.734694,\"pctr\":0.637246},{\"precise\":0.714286, \"recall\":0.714286,\"pctr\":0.63814},{\"precise\":0.708333, \"recall\":0.693878,\"pctr\":0.647823},{\"precise\":0.702128, \"recall\":0.673469,\"pctr\":0.662795},{\"precise\":0.695652, \"recall\":0.653061,\"pctr\":0.673188},{\"precise\":0.688889, \"recall\":0.632653,\"pctr\":0.675776},{\"precise\":0.681818, \"recall\":0.612245,\"pctr\":0.679484},{\"precise\":0.674419, \"recall\":0.591837,\"pctr\":0.680074},{\"precise\":0.666667, \"recall\":0.571429,\"pctr\":0.690871},{\"precise\":0.658537, \"recall\":0.55102,\"pctr\":0.699936},{\"precise\":0.675, \"recall\":0.55102,\"pctr\":0.70048},{\"precise\":0.666667, \"recall\":0.530612,\"pctr\":0.712758},{\"precise\":0.684211, \"recall\":0.530612,\"pctr\":0.716286},{\"precise\":0.675676, \"recall\":0.510204,\"pctr\":0.721316},{\"precise\":0.694444, \"recall\":0.510204,\"pctr\":0.722221},{\"precise\":0.685714, \"recall\":0.489796,\"pctr\":0.725274},{\"precise\":0.676471, \"recall\":0.469388,\"pctr\":0.725731},{\"precise\":0.69697, \"recall\":0.469388,\"pctr\":0.727227},{\"precise\":0.6875, \"recall\":0.44898,\"pctr\":0.73137},{\"precise\":0.677419, \"recall\":0.428571,\"pctr\":0.733386},{\"precise\":0.7, \"recall\":0.428571,\"pctr\":0.733978},{\"precise\":0.689655, \"recall\":0.408163,\"pctr\":0.734181},{\"precise\":0.678571, \"recall\":0.387755,\"pctr\":0.734697},{\"precise\":0.666667, \"recall\":0.367347,\"pctr\":0.738629},{\"precise\":0.653846, \"recall\":0.346939,\"pctr\":0.741727},{\"precise\":0.64, \"recall\":0.326531,\"pctr\":0.742114},{\"precise\":0.625, \"recall\":0.306122,\"pctr\":0.743503},{\"precise\":0.608696, \"recall\":0.285714,\"pctr\":0.747812},{\"precise\":0.636364, \"recall\":0.285714,\"pctr\":0.750835},{\"precise\":0.619048, \"recall\":0.265306,\"pctr\":0.7523},{\"precise\":0.6, \"recall\":0.244898,\"pctr\":0.756893},{\"precise\":0.631579, \"recall\":0.244898,\"pctr\":0.757837},{\"precise\":0.611111, \"recall\":0.22449,\"pctr\":0.758011},{\"precise\":0.588235, \"recall\":0.204082,\"pctr\":0.761057},{\"precise\":0.625, \"recall\":0.204082,\"pctr\":0.761485},{\"precise\":0.666667, \"recall\":0.204082,\"pctr\":0.767142},{\"precise\":0.642857, \"recall\":0.183673,\"pctr\":0.770279},{\"precise\":0.615385, \"recall\":0.163265,\"pctr\":0.770769},{\"precise\":0.666667, \"recall\":0.163265,\"pctr\":0.77091},{\"precise\":0.636364, \"recall\":0.142857,\"pctr\":0.771361},{\"precise\":0.6, \"recall\":0.122449,\"pctr\":0.7714},{\"precise\":0.666667, \"recall\":0.122449,\"pctr\":0.772949},{\"precise\":0.625, \"recall\":0.102041,\"pctr\":0.773744},{\"precise\":0.571429, \"recall\":0.0816327,\"pctr\":0.775432},{\"precise\":0.666667, \"recall\":0.0816327,\"pctr\":0.775589},{\"precise\":0.6, \"recall\":0.0612245,\"pctr\":0.780286},{\"precise\":0.5, \"recall\":0.0408163,\"pctr\":0.783307},{\"precise\":0.333333, \"recall\":0.0204082,\"pctr\":0.783679},{\"precise\":0.5, \"recall\":0.0204082,\"pctr\":0.784428},{\"precise\":1, \"recall\":0.0204082,\"pctr\":0.787467}] },\"confusion_matrix\":[[{\"value\":\"\"},{\"value\":\"1\"},{\"value\":\"0\"}],[{\"value\":\"1\"},{\"value\":\"47\", \"percent\":0.635135 },{\"value\":\"2\", \"percent\":0.027027}],[{\"value\":\"0\"},{\"value\":\"22\", \"percent\":0.297297 },{\"value\":\"3\", \"percent\":0.0405405}]],\"lift_chart\":[{\"label\":1, \"x_y\":[{\"x\":0.02, \"y\":1.5102, \"pctr\":0.787467},{\"x\":0.04, \"y\":0.755102, \"pctr\":0.784428},{\"x\":0.06, \"y\":1.13265, \"pctr\":0.783307},{\"x\":0.08, \"y\":1.20816, \"pctr\":0.780286},{\"x\":0.1, \"y\":1.07872, \"pctr\":0.775432},{\"x\":0.12, \"y\":1.13265, \"pctr\":0.773744},{\"x\":0.14, \"y\":1.05714, \"pctr\":0.7714},{\"x\":0.16, \"y\":1.09833, \"pctr\":0.771361},{\"x\":0.18, \"y\":1.04553, \"pctr\":0.770769},{\"x\":0.2, \"y\":1.07872, \"pctr\":0.770279},{\"x\":0.22, \"y\":0.943878, \"pctr\":0.761485},{\"x\":0.24, \"y\":0.977191, \"pctr\":0.761057},{\"x\":0.26, \"y\":0.953813, \"pctr\":0.757837},{\"x\":0.28, \"y\":0.981633, \"pctr\":0.756893},{\"x\":0.3, \"y\":0.961039, \"pctr\":0.750835},{\"x\":0.32, \"y\":0.984916, \"pctr\":0.747812},{\"x\":0.34, \"y\":1.02694, \"pctr\":0.742114},{\"x\":0.36, \"y\":1.04553, \"pctr\":0.741727},{\"x\":0.38, \"y\":1.07872, \"pctr\":0.734697},{\"x\":0.4, \"y\":1.0936, \"pctr\":0.734181},{\"x\":0.42, \"y\":1.07176, \"pctr\":0.733386},{\"x\":0.44, \"y\":1.08546, \"pctr\":0.73137},{\"x\":0.46, \"y\":1.06603, \"pctr\":0.725731},{\"x\":0.48, \"y\":1.07872, \"pctr\":0.725274},{\"x\":0.5, \"y\":1.06122, \"pctr\":0.721316},{\"x\":0.52, \"y\":1.0333, \"pctr\":0.716286},{\"x\":0.54, \"y\":1.04553, \"pctr\":0.712758},{\"x\":0.56, \"y\":1.03136, \"pctr\":0.699936},{\"x\":0.58, \"y\":1.04276, \"pctr\":0.690871},{\"x\":0.6, \"y\":1.06401, \"pctr\":0.679484},{\"x\":0.62, \"y\":1.07392, \"pctr\":0.675776},{\"x\":0.64, \"y\":1.09249, \"pctr\":0.662795},{\"x\":0.66, \"y\":1.10119, \"pctr\":0.647823},{\"x\":0.68, \"y\":1.11755, \"pctr\":0.637246},{\"x\":0.7, \"y\":1.09564, \"pctr\":0.61837},{\"x\":0.72, \"y\":1.08279, \"pctr\":0.57242},{\"x\":0.74, \"y\":1.0907, \"pctr\":0.570432},{\"x\":0.76, \"y\":1.07872, \"pctr\":0.564805},{\"x\":0.78, \"y\":1.08629, \"pctr\":0.557888},{\"x\":0.8, \"y\":1.04946, \"pctr\":0.551225},{\"x\":0.82, \"y\":1.05714, \"pctr\":0.547141},{\"x\":0.84, \"y\":1.07176, \"pctr\":0.49577},{\"x\":0.86, \"y\":1.05475, \"pctr\":0.485212},{\"x\":0.88, \"y\":1.02229, \"pctr\":0.479892},{\"x\":0.9, \"y\":1.02968, \"pctr\":0.469313},{\"x\":0.92, \"y\":1.04382, \"pctr\":0.407275},{\"x\":0.94, \"y\":1.02869, \"pctr\":0.400387},{\"x\":0.96, \"y\":0.999713, \"pctr\":0.381605},{\"x\":0.98, \"y\":1.0068, \"pctr\":0.37832},{\"x\":1, \"y\":0.489796, \"pctr\":0.725731}]}],\"ks\":[{\"label\":1, \"x_y\":[{\"x\":0.02, \"y_tpr\":0.0204082, \"y_fpr\":0,\"prop\":0.788329, \"diff\":0.0204082},{\"x\":0.04, \"y_tpr\":0.0204082, \"y_fpr\":0.04,\"prop\":0.787467, \"diff\":-0.0195918},{\"x\":0.06, \"y_tpr\":0.0408163, \"y_fpr\":0.08,\"prop\":0.783679, \"diff\":-0.0391837},{\"x\":0.08, \"y_tpr\":0.0612245, \"y_fpr\":0.08,\"prop\":0.783307, \"diff\":-0.0187755},{\"x\":0.1, \"y_tpr\":0.0816327, \"y_fpr\":0.12,\"prop\":0.775589, \"diff\":-0.0383673},{\"x\":0.12, \"y_tpr\":0.102041, \"y_fpr\":0.12,\"prop\":0.775432, \"diff\":-0.0179592},{\"x\":0.14, \"y_tpr\":0.122449, \"y_fpr\":0.16,\"prop\":0.772949, \"diff\":-0.037551},{\"x\":0.16, \"y_tpr\":0.142857, \"y_fpr\":0.16,\"prop\":0.7714, \"diff\":-0.0171429},{\"x\":0.18, \"y_tpr\":0.163265, \"y_fpr\":0.2,\"prop\":0.77091, \"diff\":-0.0367347},{\"x\":0.2, \"y_tpr\":0.183673, \"y_fpr\":0.2,\"prop\":0.770769, \"diff\":-0.0163265},{\"x\":0.22, \"y_tpr\":0.204082, \"y_fpr\":0.24,\"prop\":0.767142, \"diff\":-0.0359184},{\"x\":0.24, \"y_tpr\":0.204082, \"y_fpr\":0.28,\"prop\":0.761485, \"diff\":-0.0759184},{\"x\":0.26, \"y_tpr\":0.244898, \"y_fpr\":0.28,\"prop\":0.758011, \"diff\":-0.035102},{\"x\":0.28, \"y_tpr\":0.244898, \"y_fpr\":0.32,\"prop\":0.757837, \"diff\":-0.075102},{\"x\":0.3, \"y_tpr\":0.285714, \"y_fpr\":0.32,\"prop\":0.7523, \"diff\":-0.0342857},{\"x\":0.32, \"y_tpr\":0.285714, \"y_fpr\":0.36,\"prop\":0.750835, \"diff\":-0.0742857},{\"x\":0.34, \"y_tpr\":0.326531, \"y_fpr\":0.36,\"prop\":0.743503, \"diff\":-0.0334694},{\"x\":0.36, \"y_tpr\":0.346939, \"y_fpr\":0.36,\"prop\":0.742114, \"diff\":-0.0130612},{\"x\":0.38, \"y_tpr\":0.387755, \"y_fpr\":0.36,\"prop\":0.738629, \"diff\":0.0277551},{\"x\":0.4, \"y_tpr\":0.408163, \"y_fpr\":0.36,\"prop\":0.734697, \"diff\":0.0481633},{\"x\":0.42, \"y_tpr\":0.428571, \"y_fpr\":0.4,\"prop\":0.733978, \"diff\":0.0285714},{\"x\":0.44, \"y_tpr\":0.44898, \"y_fpr\":0.4,\"prop\":0.733386, \"diff\":0.0489796},{\"x\":0.46, \"y_tpr\":0.469388, \"y_fpr\":0.44,\"prop\":0.727227, \"diff\":0.0293878},{\"x\":0.48, \"y_tpr\":0.489796, \"y_fpr\":0.44,\"prop\":0.725731, \"diff\":0.0497959},{\"x\":0.5, \"y_tpr\":0.510204, \"y_fpr\":0.48,\"prop\":0.722221, \"diff\":0.0302041},{\"x\":0.52, \"y_tpr\":0.530612, \"y_fpr\":0.48,\"prop\":0.721316, \"diff\":0.0506122},{\"x\":0.54, \"y_tpr\":0.530612, \"y_fpr\":0.52,\"prop\":0.716286, \"diff\":0.0106122},{\"x\":0.56, \"y_tpr\":0.55102, \"y_fpr\":0.56,\"prop\":0.70048, \"diff\":-0.00897959},{\"x\":0.58, \"y_tpr\":0.571429, \"y_fpr\":0.56,\"prop\":0.699936, \"diff\":0.0114286},{\"x\":0.6, \"y_tpr\":0.612245, \"y_fpr\":0.56,\"prop\":0.680074, \"diff\":0.0522449},{\"x\":0.62, \"y_tpr\":0.632653, \"y_fpr\":0.56,\"prop\":0.679484, \"diff\":0.0726531},{\"x\":0.64, \"y_tpr\":0.673469, \"y_fpr\":0.56,\"prop\":0.673188, \"diff\":0.113469},{\"x\":0.66, \"y_tpr\":0.693878, \"y_fpr\":0.56,\"prop\":0.662795, \"diff\":0.133878},{\"x\":0.68, \"y_tpr\":0.734694, \"y_fpr\":0.56,\"prop\":0.63814, \"diff\":0.174694},{\"x\":0.7, \"y_tpr\":0.755102, \"y_fpr\":0.56,\"prop\":0.637246, \"diff\":0.195102, \"key_value\":1},{\"x\":0.72, \"y_tpr\":0.755102, \"y_fpr\":0.64,\"prop\":0.618335, \"diff\":0.115102},{\"x\":0.74, \"y_tpr\":0.77551, \"y_fpr\":0.64,\"prop\":0.57242, \"diff\":0.13551},{\"x\":0.76, \"y_tpr\":0.816327, \"y_fpr\":0.64,\"prop\":0.570137, \"diff\":0.176327},{\"x\":0.78, \"y_tpr\":0.816327, \"y_fpr\":0.68,\"prop\":0.564805, \"diff\":0.136327},{\"x\":0.8, \"y_tpr\":0.836735, \"y_fpr\":0.72,\"prop\":0.557888, \"diff\":0.116735},{\"x\":0.82, \"y_tpr\":0.836735, \"y_fpr\":0.76,\"prop\":0.551225, \"diff\":0.0767347},{\"x\":0.84, \"y_tpr\":0.877551, \"y_fpr\":0.76,\"prop\":0.541722, \"diff\":0.117551},{\"x\":0.86, \"y_tpr\":0.897959, \"y_fpr\":0.76,\"prop\":0.49577, \"diff\":0.137959},{\"x\":0.88, \"y_tpr\":0.897959, \"y_fpr\":0.88,\"prop\":0.479892, \"diff\":0.0179592},{\"x\":0.9, \"y_tpr\":0.897959, \"y_fpr\":0.88,\"prop\":0.479892, \"diff\":0.0179592},{\"x\":0.92, \"y_tpr\":0.938776, \"y_fpr\":0.88,\"prop\":0.461631, \"diff\":0.0587755},{\"x\":0.94, \"y_tpr\":0.959184, \"y_fpr\":0.88,\"prop\":0.407275, \"diff\":0.0791837},{\"x\":0.96, \"y_tpr\":0.959184, \"y_fpr\":0.96,\"prop\":0.396323, \"diff\":-0.000816327},{\"x\":0.98, \"y_tpr\":0.959184, \"y_fpr\":1,\"prop\":0.381605, \"diff\":-0.0408163},{\"x\":1, \"y_tpr\":1, \"y_fpr\":1,\"prop\":0.37782, \"diff\":0}]}]}]}");
			DefaultCategoryDataset dataset = new DefaultCategoryDataset();
			JsonObject model = modelExplainJson.get("models").getAsJsonArray().get(0).getAsJsonObject();
			JsonArray x_y = model.get("roc").getAsJsonObject().get("x_y").getAsJsonArray();
			final String series1 = "ROC";
			final String series2 = "Base line";
			for(int i=0;i<x_y.size();i++){
				JsonObject obj = x_y.get(i).getAsJsonObject();
				dataset.addValue(obj.get("y_value").getAsFloat(),series1,String.format("%.2f", obj.get("x_value").getAsFloat()));
				//dataset.addValue(1,series2,"1");
			}
			dataset.addValue(1,series2,"1");
			drawLineChart("ROC", "FPR", "TPR",1024, 1024, dataset, output+"\\roc_chart.jpg");
			map.put("roc_chart",output+"\\roc_chart.jpg");
		} catch (Exception e) {
			throw new BaseException(1,"数据错误");
		}
	}
	
	
	public Map<String,String> genPdf(DataCheckResultWithBLOBs dataCheckResult,ModelExplain modelExplain,String output) throws BaseException {
		this.output = output;
		JsonObject dataCheckResultJson = JsonUtil.toJsonObject(dataCheckResult.getDataResult());
		drawFeatureChart(dataCheckResultJson);
		//drawTable(dataCheckResultJson);
		JsonObject modelExplainJson = JsonUtil.toJsonObject(modelExplain.getModelExplain());
		drawFeatureImportanceChart(modelExplainJson);
		drawLiftChart(modelExplainJson);
		drawRecallbackChart(modelExplainJson);
		drawKSChart(modelExplainJson);
		drawRocChart(modelExplainJson);
		return map;
	}
	
	public static void main(String[] args) {
		ChartService cs = new ChartService();
		/*cs.drawFeatureChart(null);
		cs.drawLiftChart(null);
		cs.drawRecallbackChart(null); //#2983c0 #c43a38
		cs.drawKSChart(null);*/
		//cs.drawRocChart(null);
		
		//cs.drawTable(null);
		/*File file = new File("D:\\test\\pdf\\test.jpg");
		Path p = Paths.get(file.getAbsolutePath());
		BasicFileAttributes a;
		try {
			a = Files.getFileAttributeView(p, BasicFileAttributeView.class)
			        .readAttributes();
			System.out.println(FileUtils.byteCountToDisplaySize(a.size()));
			
		} catch (IOException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		};*/
		System.out.println(String.format("%.2f", 123.5463430));
		
	}
}
